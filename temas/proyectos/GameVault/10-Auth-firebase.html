<!DOCTYPE html><html lang="es" class="no-js"><head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://jssdocente.github.io/pmdm2526d/temas/proyectos/GameVault/10-Auth-firebase.html">
      
      
        <link rel="prev" href="09-DI-Koin.html">
      
      
        <link rel="next" href="11-Auth-google.html">
      
      
        
      
      
      <link rel="icon" href="../../../imagenes/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>10. Autenticación con Firebase - 2º DAM - Programación Multimedia y Desarrollo móvil - Curso 25/26</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      

  
  
  
  
  <style>:root{--md-annotation-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22M17%2013h-4v4h-2v-4H7v-2h4V7h2v4h4m-5-9A10%2010%200%200%200%202%2012a10%2010%200%200%200%2010%2010%2010%2010%200%200%200%2010-10A10%2010%200%200%200%2012%202%22/%3E%3C/svg%3E');}</style>


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../extra/css/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  <link href="../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"><script src="../../../assets/javascripts/glightbox.min.js"></script><style id="glightbox-style">
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color); }
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color); }
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color); }
        </style></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="Teal">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#10-autenticacion-con-firebase" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href="../../../index.html" title="2º DAM - Programación Multimedia y Desarrollo móvil - Curso 25/26" class="md-header__button md-logo" aria-label="2º DAM - Programación Multimedia y Desarrollo móvil - Curso 25/26" data-md-component="logo">
      
  <img src="../../../imagenes/logofp.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            2º DAM - Programación Multimedia y Desarrollo móvil - Curso 25/26
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              10. Autenticación con Firebase
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="Teal" aria-label="Cambiar a modo noche" type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Cambiar a modo noche" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"></path></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="light-blue" data-md-color-accent="Teal" aria-label="Cambiar a modo día" type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Cambiar a modo día" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"></path></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
      </label>
      <nav class="md-search__options" aria-label="Buscar">
        
        <button type="reset" class="md-search__icon md-icon" title="Limpiar" aria-label="Limpiar" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../index.html" title="2º DAM - Programación Multimedia y Desarrollo móvil - Curso 25/26" class="md-nav__button md-logo" aria-label="2º DAM - Programación Multimedia y Desarrollo móvil - Curso 25/26" data-md-component="logo">
      
  <img src="../../../imagenes/logofp.png" alt="logo">

    </a>
    2º DAM - Programación Multimedia y Desarrollo móvil - Curso 25/26
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Inicio
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2">
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Android
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Android
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00-android/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Inicio
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2">
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    El lenguaje kotlin
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    El lenguaje kotlin
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00-android/00-kotlin/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introducción
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00-android/00-kotlin/11-variables-tipos-datos.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Variables
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00-android/00-kotlin/12-expresiones-vs-sentencias.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Expresiones vs Sentencias
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00-android/00-kotlin/12.1-when.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    When
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00-android/00-kotlin/13-funciones-lambdas.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Funciones y lambdas
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00-android/00-kotlin/14-null-safety.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Null safety
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_7">
        
          
          <label class="md-nav__link" for="__nav_2_2_7" id="__nav_2_2_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Colecciones
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Colecciones
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00-android/00-kotlin/41-arrays.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Arrays
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00-android/00-kotlin/42-listas.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Listas
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00-android/00-kotlin/43-maps.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Maps
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00-android/00-kotlin/44-sets.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Sets
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00-android/00-kotlin/21-poo.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    POO
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00-android/00-kotlin/22-objetos-anonimos.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Objetos anónimos
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00-android/00-kotlin/23-data-classes.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Data classes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00-android/00-kotlin/24-enum-classes.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Enum classes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00-android/00-kotlin/25-genericos.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Genéricos
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00-android/00-kotlin/26-sealed-classes.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Clases selladas
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00-android/00-kotlin/31-scope-functions.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Scope functions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00-android/00-kotlin/52-corrutinas-sencillo.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Corrutinas
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3">
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Herramientas Proyecto Android
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Herramientas Proyecto Android
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00-android/00-tools/01-gradle-agp-estructura.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Gradle
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00-android/00-tools/02-build-gradle.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Build-gradle
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00-android/00-tools/03-android-manifest.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Fichero Manifest
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4">
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Jetpack Compose
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Jetpack Compose
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00-android/00-compose/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introducción
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00-android/00-compose/21-composable-functions.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Funciones componibles
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00-android/00-compose/22-state-management.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Gestión del estado
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00-android/00-compose/23-listas-cuadriculas.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Listas
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00-android/00-compose/24-navegacion-rutas.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Navegación Rutas
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00-android/00-compose/25-material-design.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Material Design
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00-android/00-compose/99-glosario-android.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Glosario
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../01/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    UT1 - Visión General y Entorno de desarrollo
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4">
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    UT2 - Programación de aplicaciones de móviles con Android
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    UT2 - Programación de aplicaciones de móviles con Android
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../02/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Inicio
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../02/2.1-primeros-pasos.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2.1. Primeros pasos
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../02/2.2-ciclo-vida-app.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2.2. Ciclo de Vida
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../02/2.3-primera-app.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2.3. Primera aplicación
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../02/2.4-gestion-estado.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2.4. Gestión del estado
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../02/2.5-mejorando-codigo.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2.5. Mejorando el código
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../02/2.6-mostrar-listas.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2.6. Manejo de listas
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5">
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    UT3 - Interfaz de Usuario
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    UT3 - Interfaz de Usuario
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../03/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Inicio
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../03/3.1-intro.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    3.1. Introducción
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../03/3.2-temas.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    3.2. Temas
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_4">
        
          
          <label class="md-nav__link" for="__nav_5_4" id="__nav_5_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    3.3. Arquitectura
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    3.3. Arquitectura
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../03/3.3-arquitectura.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    3.3.1. Introducción
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../03/3.3.2-arquitectura.capa-ui" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    3.3.2. Capa de UI
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../03/3.3.3-arquitectura.capa-datos.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    3.3.3. Capas Datos/Dominio
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_4_4">
        
          
          <label class="md-nav__link" for="__nav_5_4_4" id="__nav_5_4_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    3.3.4. Clean Architecture
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_4_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    3.3.4. Clean Architecture
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../03/3.3.3.2-CapaDominio-es.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Capa de Dominio
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../03/3.3.3.3-CapaDatos-es.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Capa de Datos
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6">
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    UT4 - Persistencia
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    UT4 - Persistencia
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../04/4.0-persistencia.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introducción
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../04/4.1-room.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    4.1. Room
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../04/4.2-conexion-internet.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    4.2. Conexión a Internet
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Proyecto Guía
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Proyecto Guía
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introducción
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="01-configuracion-proyecto.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    1. Configuración proyecto
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="02-LoginScreen.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2. Pantalla Login
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="03-Preferences.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    3. Preferencias
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="04-Register-logout.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    4. Registro y logout
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="05-HomeScreen.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    5. HomeScreen
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="06-DetailScreen.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    6. Detalles de un juego
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="07-RoomPersistence.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    7. Persistencia con Room
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="08-LibraryAndDetailAdvanced.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    8. Biblioteca y detalles avanzados
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="09-DI-Koin.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    9. Inyección de dependencias con Koin
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    10. Autenticación con Firebase
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="10-Auth-firebase.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    10. Autenticación con Firebase
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-introduccion-a-firebase" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Introducción a Firebase
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. Introducción a Firebase">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-que-es-firebase" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.1. ¿Qué es Firebase?
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-servicios-principales-de-firebase-para-android" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.2. Servicios principales de Firebase para Android
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-por-que-usar-firebase-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.3. ¿Por qué usar Firebase Authentication?
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#15-arquitectura-de-firebase-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.5. Arquitectura de Firebase Authentication
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-configuracion-de-firebase-en-el-proyecto" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Configuración de Firebase en el proyecto
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Configuración de Firebase en el proyecto">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-requisitos-previos" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.1. Requisitos previos
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-crear-proyecto-en-firebase-console" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2. Crear proyecto en Firebase Console
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-descargar-google-servicesjson" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.3. Descargar google-services.json
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24-que-es-el-bom-bill-of-materials" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.4. ¿Qué es el BoM (Bill of Materials)?
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#25-configurar-dependencias-con-bom" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.5. Configurar dependencias con BoM
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#26-verificar-la-configuracion" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.6. Verificar la configuración
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#27-google-servicesjson-en-profundidad" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.7. google-services.json en profundidad
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-autenticacion-conceptos-y-practica" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Autenticación: Conceptos y práctica
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Autenticación: Conceptos y práctica">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-que-es-la-autenticacion" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.1. ¿Qué es la autenticación?
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-autenticacion-con-emailpassword" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.2. Autenticación con Email/Password
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="11-Auth-google.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    11. Autenticación con Google
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-introduccion-a-firebase" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Introducción a Firebase
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. Introducción a Firebase">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-que-es-firebase" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.1. ¿Qué es Firebase?
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-servicios-principales-de-firebase-para-android" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.2. Servicios principales de Firebase para Android
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-por-que-usar-firebase-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.3. ¿Por qué usar Firebase Authentication?
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#15-arquitectura-de-firebase-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.5. Arquitectura de Firebase Authentication
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-configuracion-de-firebase-en-el-proyecto" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Configuración de Firebase en el proyecto
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Configuración de Firebase en el proyecto">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-requisitos-previos" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.1. Requisitos previos
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-crear-proyecto-en-firebase-console" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2. Crear proyecto en Firebase Console
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-descargar-google-servicesjson" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.3. Descargar google-services.json
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24-que-es-el-bom-bill-of-materials" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.4. ¿Qué es el BoM (Bill of Materials)?
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#25-configurar-dependencias-con-bom" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.5. Configurar dependencias con BoM
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#26-verificar-la-configuracion" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.6. Verificar la configuración
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#27-google-servicesjson-en-profundidad" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.7. google-services.json en profundidad
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-autenticacion-conceptos-y-practica" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Autenticación: Conceptos y práctica
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Autenticación: Conceptos y práctica">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-que-es-la-autenticacion" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.1. ¿Qué es la autenticación?
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-autenticacion-con-emailpassword" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.2. Autenticación con Email/Password
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
                



  


  <nav class="md-path" aria-label="Navegación">
    <ol class="md-path__list">
      
        
  
  
    <li class="md-path__item">
      <a href="../../../index.html" class="md-path__link">
        
  <span class="md-ellipsis">
    Inicio
  </span>

      </a>
    </li>
  

      
      
        
  
  
    
    
      <li class="md-path__item">
        <a href="index.html" class="md-path__link">
          
  <span class="md-ellipsis">
    Proyecto Guía
  </span>

        </a>
      </li>
    
  

      
    </ol>
  </nav>

              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="10-autenticacion-con-firebase"><strong>10. Autenticación con Firebase</strong><a class="headerlink" href="#10-autenticacion-con-firebase" title="Permanent link">¶</a></h1>
<p>En esta 10ª parte del proyecto, integraremos <strong>Firebase Authentication</strong> en nuestra aplicación. Gracias a la arquitectura de Inyección de Dependencias que implementamos en el capítulo anterior, este cambio será transparente para nuestros ViewModels y UI. Aprenderemos a configurar Firebase, implementar autenticación con email/password y agregar autenticación con Google como proveedor OAuth.</p>
<div class="admonition tip">
<p class="admonition-title">Repositorio de la Aplicación</p>
<p>El código fuente de la aplicación se encuentra en el repositorio de GitHub: <a href="https://github.com/jssdocente/MyGameStore">MyGameStore</a></p>
</div>
<h4 id="resumen">Resumen<a class="headerlink" href="#resumen" title="Permanent link">¶</a></h4>
<ol>
<li>Introducción a Firebase</li>
<li>Configuración de Firebase en el proyecto</li>
<li>Autenticación: Conceptos y práctica</li>
</ol>
<hr>
<h2 id="1-introduccion-a-firebase"><strong>1. Introducción a Firebase</strong><a class="headerlink" href="#1-introduccion-a-firebase" title="Permanent link">¶</a></h2>
<h3 id="11-que-es-firebase">1.1. ¿Qué es Firebase?<a class="headerlink" href="#11-que-es-firebase" title="Permanent link">¶</a></h3>
<p><strong>Firebase</strong> es una plataforma <strong>BaaS (Backend as a Service)</strong> desarrollada por Google que proporciona un conjunto completo de herramientas y servicios para desarrollar aplicaciones móviles y web sin necesidad de gestionar infraestructura de servidor.</p>
<h4 id="analogia-del-restaurante">Analogía del restaurante<a class="headerlink" href="#analogia-del-restaurante" title="Permanent link">¶</a></h4>
<p>Imagina que estás montando un restaurante:</p>
<p><strong>Sin Firebase (Backend tradicional):</strong>
</p><div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>Tú debes:
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>├─ Comprar y configurar servidores físicos
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>├─ Instalar y mantener bases de datos
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>├─ Configurar sistemas de autenticación
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>├─ Implementar APIs REST
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>├─ Gestionar escalabilidad
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>├─ Monitorear logs y errores
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>└─ Configurar backups y seguridad
</span></code></pre></div><p></p>
<p><strong>Con Firebase:</strong>
</p><div class="language-text highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>Firebase proporciona:
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>├─ Servidores en la nube (gestionados por Google)
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>├─ Base de datos lista para usar
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>├─ Sistema de autenticación completo
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>├─ APIs automáticas
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>├─ Escalabilidad automática
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>├─ Monitoreo integrado
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>└─ Backups automáticos
</span></code></pre></div><p></p>
<p>Tú solo te enfocas en <strong>cocinar</strong> (desarrollar tu app), no en <strong>gestionar el local</strong> (infraestructura).</p>
<hr>
<h3 id="12-servicios-principales-de-firebase-para-android">1.2. Servicios principales de Firebase para Android<a class="headerlink" href="#12-servicios-principales-de-firebase-para-android" title="Permanent link">¶</a></h3>
<p>Firebase ofrece más de 20 servicios. Aquí están los más relevantes para desarrollo Android:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:3"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio"><input id="__tabbed_1_2" name="__tabbed_1" type="radio"><input id="__tabbed_1_3" name="__tabbed_1" type="radio"><div class="tabbed-labels"><label for="__tabbed_1_1"><strong>🔐 Servicios Core (Infraestructura)</strong></label><label for="__tabbed_1_2"><strong>📊 Servicios de Crecimiento</strong></label><label for="__tabbed_1_3"><strong>🧪 Servicios de Calidad</strong></label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><strong>1. Firebase Authentication</strong></p>
<ul>
<li>Sistema completo de gestión de usuarios</li>
<li>Múltiples proveedores: Email, Google, Facebook, Twitter, GitHub</li>
<li>Gestión de sesiones y tokens JWT</li>
<li><strong>Ideal para:</strong> Login, registro, recuperación de contraseña</li>
</ul>
<p><strong>2. Cloud Firestore</strong></p>
<ul>
<li>Base de datos NoSQL en tiempo real</li>
<li>Sincronización automática entre dispositivos</li>
<li>Consultas potentes y escalables</li>
<li><strong>Ideal para:</strong> Datos estructurados (usuarios, posts, productos)</li>
</ul>
<p><strong>3. Realtime Database</strong></p>
<ul>
<li>Base de datos NoSQL en tiempo real (versión legacy)</li>
<li>Menor funcionalidad que Firestore</li>
<li>Sincronización ultra-rápida</li>
<li><strong>Ideal para:</strong> Chat en tiempo real, presencia de usuarios</li>
</ul>
<p><strong>4. Cloud Storage</strong></p>
<ul>
<li>Almacenamiento de archivos (imágenes, videos, PDFs)</li>
<li>CDN integrado para acceso rápido</li>
<li>Gestión de permisos por usuario</li>
<li><strong>Ideal para:</strong> Avatares, fotos de productos, documentos</li>
</ul>
</div>
<div class="tabbed-block">
<p><strong>5. Cloud Messaging (FCM)</strong></p>
<ul>
<li>Notificaciones push a dispositivos</li>
<li>Segmentación de usuarios</li>
<li>Programación de mensajes</li>
<li><strong>Ideal para:</strong> Notificaciones de nuevos contenidos, ofertas</li>
</ul>
<p><strong>6. Analytics</strong>
- Análisis de comportamiento de usuarios
- Eventos personalizados
- Integración con Google Ads
- <strong>Ideal para:</strong> Medir conversiones, retención de usuarios</p>
<p><strong>7. Crashlytics</strong>
- Reportes automáticos de crashes
- Stack traces detallados
- Priorización de errores por impacto
- <strong>Ideal para:</strong> Debugging en producción</p>
<p><strong>8. Remote Config</strong>
- Configuración dinámica sin actualizar la app
- A/B testing
- Personalización por segmentos
- <strong>Ideal para:</strong> Feature flags, mensajes promocionales</p>
</div>
<div class="tabbed-block">
<p><strong>9. Performance Monitoring</strong></p>
<ul>
<li>Métricas de rendimiento de la app</li>
<li>Detección de ANRs (Application Not Responding)</li>
<li>Tiempos de carga de pantallas</li>
<li><strong>Ideal para:</strong> Optimizar velocidad de la app</li>
</ul>
<p><strong>10. Test Lab</strong>
- Testing automatizado en dispositivos reales
- Ejecución en la nube
- Screenshots automáticos
- <strong>Ideal para:</strong> Testing antes de lanzamientos</p>
<p><strong>11. App Distribution</strong>
- Distribución de versiones beta
- Invitaciones a testers
- Feedback integrado
- <strong>Ideal para:</strong> Testing con usuarios reales</p>
</div>
</div>
</div>
<hr>
<h3 id="13-por-que-usar-firebase-authentication">1.3. ¿Por qué usar Firebase Authentication?<a class="headerlink" href="#13-por-que-usar-firebase-authentication" title="Permanent link">¶</a></h3>
<p>Firebase Authentication destaca por varias razones clave:</p>
<h4 id="1-sin-backend-propio"><strong>1. Sin backend propio</strong><a class="headerlink" href="#1-sin-backend-propio" title="Permanent link">¶</a></h4>
<pre class="mermaid"><code>graph LR
    subgraph "❌ Backend tradicional"
        A1[App Android] --&gt;|API REST| B1[Tu servidor]
        B1 --&gt;|SQL| C1[Tu BD]
        B1 --&gt;|Gestionar| D1[Sesiones]
        B1 --&gt;|Implementar| E1[Seguridad]
    end

    subgraph "✅ Firebase Auth"
        A2[App Android] --&gt;|SDK| F[Firebase]
        F --&gt;|Automático| G[Todo gestionado]
    end

    style A1 fill:#ff6b6b
    style B1 fill:#ff6b6b
    style A2 fill:#6bcf7f
    style F fill:#4d96ff</code></pre>
<p><strong>Ahorro de tiempo:</strong></p>
<ul>
<li>❌ Sin Firebase: Semanas implementando autenticación segura</li>
<li>✅ Con Firebase: Minutos integrando el SDK</li>
</ul>
<hr>
<h4 id="2-multiples-proveedores-listos-para-usar"><strong>2. Múltiples proveedores listos para usar</strong><a class="headerlink" href="#2-multiples-proveedores-listos-para-usar" title="Permanent link">¶</a></h4>
<p>Firebase soporta más de 10 proveedores de autenticación:</p>
<table>
<thead>
<tr>
<th>Proveedor</th>
<th>Tipo</th>
<th>Configuración</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Email/Password</strong></td>
<td>Tradicional</td>
<td>⭐ Simple</td>
</tr>
<tr>
<td><strong>Google</strong></td>
<td>OAuth</td>
<td>⭐ Simple</td>
</tr>
<tr>
<td><strong>Facebook</strong></td>
<td>OAuth</td>
<td>⭐⭐ Media</td>
</tr>
<tr>
<td><strong>Twitter</strong></td>
<td>OAuth</td>
<td>⭐⭐ Media</td>
</tr>
<tr>
<td><strong>GitHub</strong></td>
<td>OAuth</td>
<td>⭐⭐ Media</td>
</tr>
<tr>
<td><strong>Apple</strong></td>
<td>OAuth</td>
<td>⭐⭐⭐ Compleja (iOS)</td>
</tr>
<tr>
<td><strong>Microsoft</strong></td>
<td>OAuth</td>
<td>⭐⭐ Media</td>
</tr>
<tr>
<td><strong>Teléfono</strong></td>
<td>SMS</td>
<td>⭐⭐ Media</td>
</tr>
<tr>
<td><strong>Anónima</strong></td>
<td>Temporal</td>
<td>⭐ Muy simple</td>
</tr>
<tr>
<td><strong>Personalizada</strong></td>
<td>Tokens propios</td>
<td>⭐⭐⭐ Avanzada</td>
</tr>
</tbody>
</table>
<p><strong>En este proyecto usaremos:</strong></p>
<ul>
<li>✅ Email/Password (autenticación básica)</li>
<li>✅ Google (OAuth para mejor UX)</li>
</ul>
<hr>
<h4 id="3-seguridad-robusta"><strong>3. Seguridad robusta</strong><a class="headerlink" href="#3-seguridad-robusta" title="Permanent link">¶</a></h4>
<p>Firebase maneja toda la seguridad por ti:</p>
<ul>
<li><strong>Tokens JWT</strong>: Autenticación basada en tokens seguros</li>
<li><strong>Sesiones persistentes</strong>: El usuario sigue logueado tras cerrar la app</li>
<li><strong>Renovación automática</strong>: Tokens se renuevan sin intervención</li>
<li><strong>Protección contra ataques</strong>: Rate limiting, protección CSRF</li>
</ul>
<div class="language-kotlin highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="c1">// Firebase gestiona automáticamente:</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="c1">// - Encriptación de contraseñas (bcrypt)</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="c1">// - Generación de tokens JWT</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="c1">// - Renovación de sesiones</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="c1">// - Revocación de tokens</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="c1">// Tú solo haces:</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="n">firebaseAuth</span><span class="p">.</span><span class="na">signInWithEmailAndPassword</span><span class="p">(</span><span class="n">email</span><span class="p">,</span><span class="w"> </span><span class="n">password</span><span class="p">)</span>
</span></code></pre></div>
<hr>
<h4 id="4-escalabilidad-automatica"><strong>4. Escalabilidad automática</strong><a class="headerlink" href="#4-escalabilidad-automatica" title="Permanent link">¶</a></h4>
<table>
<thead>
<tr>
<th>Aspecto</th>
<th>Firebase</th>
<th>Backend propio</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Usuarios concurrentes</strong></td>
<td>Millones</td>
<td>Depende de tu servidor</td>
</tr>
<tr>
<td><strong>Gestión de carga</strong></td>
<td>Automática</td>
<td>Manual (load balancers)</td>
</tr>
<tr>
<td><strong>Costos iniciales</strong></td>
<td>$0</td>
<td>Servidor + BD + DevOps</td>
</tr>
<tr>
<td><strong>Mantenimiento</strong></td>
<td>$0 (tiempo)</td>
<td>Horas/semana</td>
</tr>
</tbody>
</table>
<p><strong>Plan gratuito de Firebase Auth:</strong></p>
<ul>
<li>✅ Autenticación ilimitada de usuarios</li>
<li>✅ 10,000 verificaciones de teléfono/mes</li>
<li>✅ Todos los proveedores incluidos</li>
</ul>
<hr>
<h4 id="5-integracion-con-otros-servicios-de-firebase"><strong>5. Integración con otros servicios de Firebase</strong><a class="headerlink" href="#5-integracion-con-otros-servicios-de-firebase" title="Permanent link">¶</a></h4>
<p>Una vez autenticado, el usuario tiene acceso controlado a:</p>
<div class="language-kotlin highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="c1">// El mismo FirebaseUser se usa en todos los servicios</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="kd">val</span><span class="w"> </span><span class="nv">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FirebaseAuth</span><span class="p">.</span><span class="na">getInstance</span><span class="p">().</span><span class="na">currentUser</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="c1">// Firestore: Reglas de seguridad por usuario</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="n">firestore</span><span class="p">.</span><span class="na">collection</span><span class="p">(</span><span class="s">"games"</span><span class="p">)</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="w">    </span><span class="p">.</span><span class="na">whereEqualTo</span><span class="p">(</span><span class="s">"userId"</span><span class="p">,</span><span class="w"> </span><span class="n">user</span><span class="p">.</span><span class="na">uid</span><span class="p">)</span><span class="w">  </span><span class="c1">// Solo sus datos</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="c1">// Storage: Permisos por usuario</span>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="n">storage</span><span class="p">.</span><span class="na">reference</span><span class="p">(</span><span class="s">"avatars/</span><span class="si">${</span><span class="n">user</span><span class="p">.</span><span class="na">uid</span><span class="si">}</span><span class="s">/profile.jpg"</span><span class="p">)</span>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a><span class="c1">// Realtime Database: Acceso controlado</span>
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a><span class="n">database</span><span class="p">.</span><span class="na">reference</span><span class="p">(</span><span class="s">"users/</span><span class="si">${</span><span class="n">user</span><span class="p">.</span><span class="na">uid</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
</span></code></pre></div>
<hr>
<h4 id="6-experiencia-de-usuario-mejorada"><strong>6. Experiencia de usuario mejorada</strong><a class="headerlink" href="#6-experiencia-de-usuario-mejorada" title="Permanent link">¶</a></h4>
<p><strong>Funcionalidades incluidas sin código adicional:</strong></p>
<ul>
<li>🔐 <strong>Recuperación de contraseña</strong>: Email automático</li>
<li>✉️ <strong>Verificación de email</strong>: Link de confirmación</li>
<li>🔄 <strong>Cambio de contraseña</strong>: Flujo seguro</li>
<li>🚪 <strong>Logout en todos los dispositivos</strong>: Revocación de tokens</li>
<li>📱 <strong>Detección de cuenta existente</strong>: Evita duplicados</li>
</ul>
<hr>
<h3 id="15-arquitectura-de-firebase-authentication">1.5. Arquitectura de Firebase Authentication<a class="headerlink" href="#15-arquitectura-de-firebase-authentication" title="Permanent link">¶</a></h3>
<pre class="mermaid"><code>graph TB
    subgraph "App Android"
        A[LoginScreen]
        B[LoginViewModel]
        C[FirebaseAuthRepository]
    end

    subgraph "Firebase SDK"
        D[FirebaseAuth]
    end

    subgraph "Firebase Cloud"
        E[Authentication Service]
        F[User Database]
        G[Token Generator]
    end

    A --&gt;|Eventos UI| B
    B --&gt;|Llama| C
    C --&gt;|SDK| D
    D --&gt;|HTTPS| E
    E --&gt;|Valida| F
    E --&gt;|Genera| G
    G --&gt;|JWT Token| D
    D --&gt;|FirebaseUser| C
    C --&gt;|LoginResult| B
    B --&gt;|UiState| A

    style A fill:#4d96ff
    style E fill:#ff6b6b
    style G fill:#6bcf7f</code></pre>
<p><strong>Flujo simplificado:</strong></p>
<ol>
<li>Usuario ingresa credenciales en la UI</li>
<li>ViewModel llama al Repository</li>
<li>Repository usa Firebase SDK</li>
<li>SDK envía credenciales a Firebase Cloud (HTTPS)</li>
<li>Firebase valida y genera token JWT</li>
<li>Token se almacena automáticamente en el dispositivo</li>
<li>Repository devuelve <code>LoginResult.Success</code></li>
<li>ViewModel actualiza el estado de la UI</li>
</ol>
<p>Perfecto, continúo con el <strong>Punto 2: Configuración de Firebase en el proyecto</strong>.</p>
<hr>
<h2 id="2-configuracion-de-firebase-en-el-proyecto"><strong>2. Configuración de Firebase en el proyecto</strong><a class="headerlink" href="#2-configuracion-de-firebase-en-el-proyecto" title="Permanent link">¶</a></h2>
<p>En esta sección aprenderás a conectar tu proyecto Android con Firebase desde cero. El proceso incluye crear el proyecto en Firebase Console, descargar la configuración y agregar las dependencias necesarias usando el <strong>BoM (Bill of Materials)</strong>.</p>
<h3 id="21-requisitos-previos">2.1. Requisitos previos<a class="headerlink" href="#21-requisitos-previos" title="Permanent link">¶</a></h3>
<p>Antes de empezar, asegúrate de tener:</p>
<ul>
<li>✅ <strong>Cuenta de Google</strong> (Gmail)</li>
<li>✅ <strong>Proyecto Android</strong> funcional en Android Studio</li>
<li>✅ <strong>Package name</strong> del proyecto (en nuestro caso: <code>com.pmdm.mygamestore</code>)</li>
<li>✅ <strong>Conexión a Internet</strong> para acceder a Firebase Console</li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Verificar el package name</p>
<p>El package name está en <code>app/build.gradle.kts</code>:
</p><div class="language-kotlin highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="n">android</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="w">        </span><span class="n">namespace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"com.pmdm.mygamestore"</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="w">        </span><span class="c1">// ...</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="w">    </span><span class="p">}</span>
</span></code></pre></div><p></p>
</div>
<h3 id="22-crear-proyecto-en-firebase-console">2.2. Crear proyecto en Firebase Console<a class="headerlink" href="#22-crear-proyecto-en-firebase-console" title="Permanent link">¶</a></h3>
<h4 id="paso-1-acceder-a-firebase-console"><strong>Paso 1: Acceder a Firebase Console</strong><a class="headerlink" href="#paso-1-acceder-a-firebase-console" title="Permanent link">¶</a></h4>
<ol>
<li>Abre tu navegador y ve a <a href="https://console.firebase.google.com/">Firebase Console</a></li>
<li>Inicia sesión con tu cuenta de Google</li>
<li>Verás el dashboard de Firebase</li>
</ol>
<h4 id="paso-2-crear-nuevo-proyecto"><strong>Paso 2: Crear nuevo proyecto</strong><a class="headerlink" href="#paso-2-crear-nuevo-proyecto" title="Permanent link">¶</a></h4>
<ol>
<li>Haz click en <strong>"Agregar proyecto"</strong> o <strong>"Create a project"</strong></li>
<li><strong>Nombre del proyecto</strong>: Escribe el nombre de tu app</li>
</ol>
<ul>
<li>Este nombre es solo para identificar el proyecto en Firebase</li>
<li>No tiene que coincidir con el nombre de tu app
3. Click en <strong>"Continuar"</strong></li>
</ul>
<h4 id="paso-3-configurar-google-analytics-opcional"><strong>Paso 3: Configurar Google Analytics (Opcional)</strong><a class="headerlink" href="#paso-3-configurar-google-analytics-opcional" title="Permanent link">¶</a></h4>
<ol>
<li>Firebase preguntará si quieres habilitar Google Analytics</li>
<li><strong>Recomendación para aprendizaje</strong>: Desactivar (puedes activarlo después)</li>
<li>Click en <strong>"Crear proyecto"</strong></li>
</ol>
<div class="admonition info">
<p class="admonition-title">Google Analytics</p>
<p>Analytics es útil en producción para medir usuarios, eventos y conversiones. Para desarrollo y aprendizaje, puedes desactivarlo inicialmente.</p>
</div>
<h4 id="paso-4-esperar-a-que-se-cree-el-proyecto"><strong>Paso 4: Esperar a que se cree el proyecto</strong><a class="headerlink" href="#paso-4-esperar-a-que-se-cree-el-proyecto" title="Permanent link">¶</a></h4>
<p>Firebase tardará unos 30-60 segundos en:</p>
<ul>
<li>Crear la infraestructura</li>
<li>Provisionar servicios</li>
<li>Configurar reglas de seguridad por defecto</li>
</ul>
<p>Cuando termine, verás: <strong>"Tu nuevo proyecto está listo"</strong></p>
<h4 id="paso-5-agregar-aplicacion-android"><strong>Paso 5: Agregar aplicación Android</strong><a class="headerlink" href="#paso-5-agregar-aplicacion-android" title="Permanent link">¶</a></h4>
<ol>
<li>En el dashboard de Firebase, verás varios íconos: iOS, Android, Web, etc.</li>
<li>Click en el ícono de <strong>Android</strong> </li>
<li>Completa el formulario:</li>
</ol>
<p><strong>a) Package name (Obligatorio):</strong>
</p><div class="language-text highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>com.pmdm.mygamestore
</span></code></pre></div><p></p>
<p>⚠️ <strong>Importante</strong>: Debe coincidir <strong>exactamente</strong> con el <code>namespace</code> de tu <code>build.gradle.kts</code></p>
<p><strong>b) App nickname (Opcional):</strong>
</p><div class="language-text highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>MyGameStore Android
</span></code></pre></div><p></p>
<p>Solo para identificar la app si tienes múltiples (Android, iOS, Web)</p>
<p><strong>c) SHA-1 Debug certificate (Opcional por ahora):</strong></p>
<ul>
<li>Déjalo vacío por ahora</li>
<li>Lo necesitaremos más adelante para <strong>Google Sign-In</strong></li>
<li>Explicaremos cómo obtenerlo en la sección 3.4</li>
</ul>
<ol start="4">
<li>Click en <strong>"Registrar app"</strong></li>
</ol>
<hr>
<h3 id="23-descargar-google-servicesjson">2.3. Descargar google-services.json<a class="headerlink" href="#23-descargar-google-servicesjson" title="Permanent link">¶</a></h3>
<p>Después de registrar la app, Firebase te mostrará una pantalla con un archivo JSON.</p>
<h4 id="que-es-google-servicesjson"><strong>¿Qué es google-services.json?</strong><a class="headerlink" href="#que-es-google-servicesjson" title="Permanent link">¶</a></h4>
<p>Es el <strong>archivo de configuración</strong> que conecta tu app con Firebase. Contiene:</p>
<div class="language-json highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="p">{</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="w">  </span><span class="nt">"project_info"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="w">    </span><span class="nt">"project_number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"123456789"</span><span class="p">,</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="w">    </span><span class="nt">"project_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"mygamestore-abc123"</span><span class="p">,</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="w">    </span><span class="nt">"storage_bucket"</span><span class="p">:</span><span class="w"> </span><span class="s2">"mygamestore-abc123.appspot.com"</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="w">  </span><span class="p">},</span>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="w">  </span><span class="nt">"client"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a><span class="w">      </span><span class="nt">"client_info"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a><span class="w">        </span><span class="nt">"mobilesdk_app_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1:123456789:android:abc123"</span><span class="p">,</span>
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a><span class="w">        </span><span class="nt">"android_client_info"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a><span class="w">          </span><span class="nt">"package_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"com.pmdm.mygamestore"</span>
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-7-15"><a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a><span class="w">      </span><span class="nt">"api_key"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-7-16"><a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-7-17"><a id="__codelineno-7-17" name="__codelineno-7-17" href="#__codelineno-7-17"></a><span class="w">          </span><span class="nt">"current_key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"AIzaSyXXXXXXXXXXXXXXXXXXXXXXXX"</span>
</span><span id="__span-7-18"><a id="__codelineno-7-18" name="__codelineno-7-18" href="#__codelineno-7-18"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-7-19"><a id="__codelineno-7-19" name="__codelineno-7-19" href="#__codelineno-7-19"></a><span class="w">      </span><span class="p">]</span>
</span><span id="__span-7-20"><a id="__codelineno-7-20" name="__codelineno-7-20" href="#__codelineno-7-20"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-7-21"><a id="__codelineno-7-21" name="__codelineno-7-21" href="#__codelineno-7-21"></a><span class="w">  </span><span class="p">]</span>
</span><span id="__span-7-22"><a id="__codelineno-7-22" name="__codelineno-7-22" href="#__codelineno-7-22"></a><span class="p">}</span>
</span></code></pre></div>
<p><strong>Campos importantes:</strong></p>
<table>
<thead>
<tr>
<th>Campo</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>project_id</code></td>
<td>ID único del proyecto Firebase</td>
</tr>
<tr>
<td><code>mobilesdk_app_id</code></td>
<td>ID único de tu app Android</td>
</tr>
<tr>
<td><code>package_name</code></td>
<td>Package de tu app (validación)</td>
</tr>
<tr>
<td><code>api_key</code></td>
<td>Clave de API para comunicarse con Firebase</td>
</tr>
</tbody>
</table>
<h4 id="descargar-el-archivo"><strong>Descargar el archivo</strong><a class="headerlink" href="#descargar-el-archivo" title="Permanent link">¶</a></h4>
<ol>
<li>Click en <strong>"Descargar google-services.json"</strong></li>
<li>Guarda el archivo (normalmente va a <code>Descargas</code>)</li>
</ol>
<h4 id="ubicar-el-archivo-en-el-proyecto"><strong>Ubicar el archivo en el proyecto</strong><a class="headerlink" href="#ubicar-el-archivo-en-el-proyecto" title="Permanent link">¶</a></h4>
<div class="admonition danger">
<p class="admonition-title">Ubicación crítica</p>
<p>El archivo <strong>DEBE</strong> estar en <code>app/google-services.json</code>, NO en la raíz del proyecto.</p>
</div>
<p><strong>Estructura correcta:</strong>
</p><div class="language-text highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>MyGameStore/
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>├─ app/
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>│  ├─ src/
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>│  ├─ build.gradle.kts
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>│  └─ google-services.json  ← AQUÍ
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>├─ gradle/
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a>└─ build.gradle.kts
</span></code></pre></div><p></p>
<p><strong>Pasos en Android Studio:</strong></p>
<ol>
<li>En el explorador de archivos, ve a la carpeta <code>app</code> de tu proyecto</li>
<li>Arrastra el archivo <code>google-services.json</code> desde <code>Descargas</code></li>
<li>Suéltalo directamente en la carpeta <code>app</code></li>
<li>Android Studio detectará el archivo automáticamente</li>
</ol>
<p><strong>Verificación:</strong></p>
<p>En la vista de proyecto (Project view), deberías ver:
</p><div class="language-text highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>app/
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>├─ manifests/
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>├─ java/
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>├─ res/
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>├─ build.gradle.kts
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a>└─ google-services.json  ✅
</span></code></pre></div><p></p>
<hr>
<h3 id="24-que-es-el-bom-bill-of-materials">2.4. ¿Qué es el BoM (Bill of Materials)?<a class="headerlink" href="#24-que-es-el-bom-bill-of-materials" title="Permanent link">¶</a></h3>
<p>El <strong>BoM de Firebase</strong> es una lista centralizada de versiones compatibles entre sí. Es como una "receta" que garantiza que todas las librerías de Firebase funcionen correctamente juntas.</p>
<h4 id="problema-sin-bom"><strong>Problema sin BoM</strong><a class="headerlink" href="#problema-sin-bom" title="Permanent link">¶</a></h4>
<p>Antes del BoM, tenías que gestionar versiones manualmente:</p>
<div class="language-kotlin highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="c1">// ❌ Sin BoM: Riesgo de incompatibilidades</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="n">implementation</span><span class="p">(</span><span class="s">"com.google.firebase:firebase-auth:21.0.1"</span><span class="p">)</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="n">implementation</span><span class="p">(</span><span class="s">"com.google.firebase:firebase-firestore:24.0.0"</span><span class="p">)</span><span class="w">  </span><span class="c1">// ⚠️ Puede no ser compatible</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="n">implementation</span><span class="p">(</span><span class="s">"com.google.firebase:firebase-analytics:21.2.0"</span><span class="p">)</span><span class="w">  </span><span class="c1">// ⚠️ Puede no ser compatible</span>
</span></code></pre></div>
<p><strong>Problemas:</strong>
- 😵 Difícil saber qué versiones son compatibles
- 🐛 Bugs sutiles por incompatibilidades
- ⏰ Tiempo perdido resolviendo conflictos</p>
<h4 id="solucion-con-bom"><strong>Solución con BoM</strong><a class="headerlink" href="#solucion-con-bom" title="Permanent link">¶</a></h4>
<div class="language-kotlin highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="c1">// ✅ Con BoM: Compatibilidad garantizada</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="n">implementation</span><span class="p">(</span><span class="n">platform</span><span class="p">(</span><span class="s">"com.google.firebase:firebase-bom:33.7.0"</span><span class="p">))</span><span class="w">  </span><span class="c1">// Una versión del BoM</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="n">implementation</span><span class="p">(</span><span class="s">"com.google.firebase:firebase-auth"</span><span class="p">)</span><span class="w">                   </span><span class="c1">// Sin versión</span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="n">implementation</span><span class="p">(</span><span class="s">"com.google.firebase:firebase-firestore"</span><span class="p">)</span><span class="w">              </span><span class="c1">// Sin versión</span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="n">implementation</span><span class="p">(</span><span class="s">"com.google.firebase:firebase-analytics"</span><span class="p">)</span><span class="w">              </span><span class="c1">// Sin versión</span>
</span></code></pre></div>
<p><strong>Ventajas:</strong></p>
<table>
<thead>
<tr>
<th>Ventaja</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td>✅ <strong>Compatibilidad garantizada</strong></td>
<td>Google asegura que todas las versiones funcionan juntas</td>
</tr>
<tr>
<td>✅ <strong>Menos código</strong></td>
<td>No repetir versiones en cada librería</td>
</tr>
<tr>
<td>✅ <strong>Actualizaciones simples</strong></td>
<td>Cambiar una sola línea (el BoM) actualiza todo</td>
</tr>
<tr>
<td>✅ <strong>Menos errores</strong></td>
<td>Imposible mezclar versiones incompatibles</td>
</tr>
</tbody>
</table>
<h4 id="como-funciona-el-bom"><strong>Cómo funciona el BoM</strong><a class="headerlink" href="#como-funciona-el-bom" title="Permanent link">¶</a></h4>
<p>º
</p><pre class="mermaid"><code>graph TD
    A[firebase-bom:33.7.0] --&gt;|define| B[firebase-auth:22.3.1]
    A --&gt;|define| C[firebase-firestore:24.10.1]
    A --&gt;|define| D[firebase-analytics:21.5.1]
    A --&gt;|define| E[firebase-storage:20.3.0]

    F[Tu app] --&gt;|usa| A
    F -.-&gt;|obtiene versión de| B
    F -.-&gt;|obtiene versión de| C
    F -.-&gt;|obtiene versión de| D

    style A fill:#ff6b6b
    style F fill:#4d96ff</code></pre><p></p>
<p>Cuando declaras el BoM, todas las librerías de Firebase <strong>heredan automáticamente</strong> la versión correcta.</p>
<hr>
<h3 id="25-configurar-dependencias-con-bom">2.5. Configurar dependencias con BoM<a class="headerlink" href="#25-configurar-dependencias-con-bom" title="Permanent link">¶</a></h3>
<p>Ahora vamos a agregar Firebase al proyecto usando el BoM.</p>
<h4 id="paso-1-agregar-versiones-en-libsversionstoml"><strong>Paso 1: Agregar versiones en libs.versions.toml</strong><a class="headerlink" href="#paso-1-agregar-versiones-en-libsversionstoml" title="Permanent link">¶</a></h4>
<p><strong>Ubicación:</strong> <code>gradle/libs.versions.toml</code></p>
<div class="language-toml highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="k">[versions]</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="c1"># ... otras versiones</span>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="n">firebaseBom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"33.7.0"</span>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="n">googleServices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"4.4.4"</span>
</span></code></pre></div>
<p><strong>¿Por qué estas versiones?</strong></p>
<ul>
<li><code>firebaseBom</code>: Versión del BoM (contiene todas las librerías Firebase)</li>
<li><code>googleServices</code>: Plugin que procesa <code>google-services.json</code></li>
</ul>
<hr>
<h4 id="paso-2-agregar-librerias-en-libsversionstoml"><strong>Paso 2: Agregar librerías en libs.versions.toml</strong><a class="headerlink" href="#paso-2-agregar-librerias-en-libsversionstoml" title="Permanent link">¶</a></h4>
<p>En la sección <code>[libraries]</code>:</p>
<div class="language-toml highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="k">[libraries]</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="c1"># ... otras librerías</span>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="c1"># Firebase BoM (Bill of Materials)</span>
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="n">firebase-bom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">"com.google.firebase"</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">"firebase-bom"</span><span class="p">,</span><span class="w"> </span><span class="n">version</span><span class="p">.</span><span class="n">ref</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">"firebaseBom"</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a>
</span><span id="__span-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="c1"># Firebase Services (sin versión, controladas por BoM)</span>
</span><span id="__span-13-8"><a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a><span class="n">firebase-auth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">"com.google.firebase"</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">"firebase-auth"</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-13-9"><a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a><span class="n">firebase-analytics</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">"com.google.firebase"</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">"firebase-analytics"</span><span class="w"> </span><span class="p">}</span>
</span></code></pre></div>
<p><strong>Observa:</strong></p>
<ul>
<li><code>firebase-bom</code> <strong>SÍ</strong> tiene <code>version.ref</code> (la versión del BoM)</li>
<li><code>firebase-auth</code> y <code>firebase-analytics</code> <strong>NO</strong> tienen versión (la heredan del BoM)</li>
</ul>
<hr>
<h4 id="paso-3-agregar-plugin-en-libsversionstoml"><strong>Paso 3: Agregar plugin en libs.versions.toml</strong><a class="headerlink" href="#paso-3-agregar-plugin-en-libsversionstoml" title="Permanent link">¶</a></h4>
<p>En la sección <code>[plugins]</code>:</p>
<div class="language-toml highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="k">[plugins]</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="c1"># ... otros plugins</span>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="n">google-services</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">"com.google.gms.google-services"</span><span class="p">,</span><span class="w"> </span><span class="n">version</span><span class="p">.</span><span class="n">ref</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">"googleServices"</span><span class="w"> </span><span class="p">}</span>
</span></code></pre></div>
<p>Este plugin es necesario para procesar el archivo <code>google-services.json</code>.</p>
<hr>
<h4 id="paso-4-aplicar-plugin-en-buildgradlekts-proyecto"><strong>Paso 4: Aplicar plugin en build.gradle.kts (proyecto)</strong><a class="headerlink" href="#paso-4-aplicar-plugin-en-buildgradlekts-proyecto" title="Permanent link">¶</a></h4>
<p><strong>Ubicación:</strong> <code>build.gradle.kts</code> (raíz del proyecto)</p>
<div class="language-kotlin highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="n">plugins</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="w">    </span><span class="n">alias</span><span class="p">(</span><span class="n">libs</span><span class="p">.</span><span class="na">plugins</span><span class="p">.</span><span class="na">android</span><span class="p">.</span><span class="na">application</span><span class="p">)</span><span class="w"> </span><span class="n">apply</span><span class="w"> </span><span class="kc">false</span>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="w">    </span><span class="n">alias</span><span class="p">(</span><span class="n">libs</span><span class="p">.</span><span class="na">plugins</span><span class="p">.</span><span class="na">kotlin</span><span class="p">.</span><span class="na">android</span><span class="p">)</span><span class="w"> </span><span class="n">apply</span><span class="w"> </span><span class="kc">false</span>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="w">    </span><span class="n">alias</span><span class="p">(</span><span class="n">libs</span><span class="p">.</span><span class="na">plugins</span><span class="p">.</span><span class="na">kotlin</span><span class="p">.</span><span class="na">compose</span><span class="p">)</span><span class="w"> </span><span class="n">apply</span><span class="w"> </span><span class="kc">false</span>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="w">    </span><span class="n">alias</span><span class="p">(</span><span class="n">libs</span><span class="p">.</span><span class="na">plugins</span><span class="p">.</span><span class="na">kotlin</span><span class="p">.</span><span class="na">serialization</span><span class="p">)</span><span class="w"> </span><span class="n">apply</span><span class="w"> </span><span class="kc">false</span>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a><span class="w">    </span><span class="n">alias</span><span class="p">(</span><span class="n">libs</span><span class="p">.</span><span class="na">plugins</span><span class="p">.</span><span class="na">ksp</span><span class="p">)</span><span class="w"> </span><span class="n">apply</span><span class="w"> </span><span class="kc">false</span>
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a><span class="w">    </span><span class="n">alias</span><span class="p">(</span><span class="n">libs</span><span class="p">.</span><span class="na">plugins</span><span class="p">.</span><span class="na">room</span><span class="p">)</span><span class="w"> </span><span class="n">apply</span><span class="w"> </span><span class="kc">false</span>
</span><span id="__span-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a>
</span><span id="__span-15-9"><a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a><span class="w">    </span><span class="c1">// 👇 Agregar plugin de Google Services</span>
</span><span id="__span-15-10"><a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a><span class="w">    </span><span class="n">alias</span><span class="p">(</span><span class="n">libs</span><span class="p">.</span><span class="na">plugins</span><span class="p">.</span><span class="na">google</span><span class="p">.</span><span class="na">services</span><span class="p">)</span><span class="w"> </span><span class="n">apply</span><span class="w"> </span><span class="kc">false</span>
</span><span id="__span-15-11"><a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a><span class="p">}</span>
</span></code></pre></div>
<p><strong>¿Por qué <code>apply false</code>?</strong></p>
<ul>
<li>El plugin se declara aquí pero se aplica en el módulo <code>app</code></li>
<li>Permite reutilizar la versión en múltiples módulos</li>
</ul>
<hr>
<h4 id="paso-5-configurar-buildgradlekts-app"><strong>Paso 5: Configurar build.gradle.kts (app)</strong><a class="headerlink" href="#paso-5-configurar-buildgradlekts-app" title="Permanent link">¶</a></h4>
<p><strong>Ubicación:</strong> <code>app/build.gradle.kts</code></p>
<p><strong>a) Aplicar el plugin al inicio:</strong></p>
<div class="language-kotlin highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="n">plugins</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="w">    </span><span class="n">alias</span><span class="p">(</span><span class="n">libs</span><span class="p">.</span><span class="na">plugins</span><span class="p">.</span><span class="na">android</span><span class="p">.</span><span class="na">application</span><span class="p">)</span>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="w">    </span><span class="n">alias</span><span class="p">(</span><span class="n">libs</span><span class="p">.</span><span class="na">plugins</span><span class="p">.</span><span class="na">kotlin</span><span class="p">.</span><span class="na">android</span><span class="p">)</span>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="w">    </span><span class="n">alias</span><span class="p">(</span><span class="n">libs</span><span class="p">.</span><span class="na">plugins</span><span class="p">.</span><span class="na">kotlin</span><span class="p">.</span><span class="na">compose</span><span class="p">)</span>
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="w">    </span><span class="n">alias</span><span class="p">(</span><span class="n">libs</span><span class="p">.</span><span class="na">plugins</span><span class="p">.</span><span class="na">kotlin</span><span class="p">.</span><span class="na">serialization</span><span class="p">)</span>
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a><span class="w">    </span><span class="n">alias</span><span class="p">(</span><span class="n">libs</span><span class="p">.</span><span class="na">plugins</span><span class="p">.</span><span class="na">ksp</span><span class="p">)</span>
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a><span class="w">    </span><span class="n">alias</span><span class="p">(</span><span class="n">libs</span><span class="p">.</span><span class="na">plugins</span><span class="p">.</span><span class="na">room</span><span class="p">)</span>
</span><span id="__span-16-8"><a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a>
</span><span id="__span-16-9"><a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a><span class="w">    </span><span class="c1">// 👇 Aplicar plugin de Google Services</span>
</span><span id="__span-16-10"><a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a><span class="w">    </span><span class="n">alias</span><span class="p">(</span><span class="n">libs</span><span class="p">.</span><span class="na">plugins</span><span class="p">.</span><span class="na">google</span><span class="p">.</span><span class="na">services</span><span class="p">)</span>
</span><span id="__span-16-11"><a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a><span class="p">}</span>
</span></code></pre></div>
<p><strong>b) Agregar dependencias Firebase:</strong></p>
<div class="language-kotlin highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="n">dependencies</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="w">    </span><span class="c1">// ... dependencias existentes</span>
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a><span class="w">    </span><span class="c1">// Firebase BoM (Bill of Materials)</span>
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a><span class="w">    </span><span class="n">implementation</span><span class="p">(</span><span class="n">platform</span><span class="p">(</span><span class="n">libs</span><span class="p">.</span><span class="na">firebase</span><span class="p">.</span><span class="na">bom</span><span class="p">))</span>
</span><span id="__span-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a>
</span><span id="__span-17-7"><a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a><span class="w">    </span><span class="c1">// Firebase Services (versiones controladas por BoM)</span>
</span><span id="__span-17-8"><a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a><span class="w">    </span><span class="n">implementation</span><span class="p">(</span><span class="n">libs</span><span class="p">.</span><span class="na">firebase</span><span class="p">.</span><span class="na">auth</span><span class="p">)</span>
</span><span id="__span-17-9"><a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a><span class="w">    </span><span class="n">implementation</span><span class="p">(</span><span class="n">libs</span><span class="p">.</span><span class="na">firebase</span><span class="p">.</span><span class="na">analytics</span><span class="p">)</span>
</span><span id="__span-17-10"><a id="__codelineno-17-10" name="__codelineno-17-10" href="#__codelineno-17-10"></a><span class="p">}</span>
</span></code></pre></div>
<p><strong>Conceptos clave:</strong></p>
<div class="language-kotlin highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="c1">// platform() indica que es un BoM</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="n">implementation</span><span class="p">(</span><span class="n">platform</span><span class="p">(</span><span class="n">libs</span><span class="p">.</span><span class="na">firebase</span><span class="p">.</span><span class="na">bom</span><span class="p">))</span>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="c1">// Las siguientes librerías NO tienen versión explícita</span>
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a><span class="n">implementation</span><span class="p">(</span><span class="n">libs</span><span class="p">.</span><span class="na">firebase</span><span class="p">.</span><span class="na">auth</span><span class="p">)</span><span class="w">  </span><span class="c1">// Versión viene del BoM</span>
</span></code></pre></div>
<hr>
<h4 id="paso-6-sincronizar-proyecto"><strong>Paso 6: Sincronizar proyecto</strong><a class="headerlink" href="#paso-6-sincronizar-proyecto" title="Permanent link">¶</a></h4>
<ol>
<li>Click en <strong>"Sync Now"</strong> (aparece en la parte superior de Android Studio)</li>
<li>Gradle descargará las dependencias de Firebase</li>
<li>Espera a que termine (puede tardar 1-2 minutos la primera vez)</li>
</ol>
<p><strong>Si hay errores de sincronización:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>Error: Failed to resolve: com.google.firebase:firebase-bom:33.7.0
</span></code></pre></div>
<p><strong>Soluciones:</strong></p>
<ol>
<li>Verifica tu conexión a Internet</li>
<li>Asegúrate de que <code>google-services.json</code> esté en <code>app/</code></li>
<li>Revisa que las versiones en <code>libs.versions.toml</code> sean correctas</li>
<li>Intenta <strong>File → Invalidate Caches / Restart</strong></li>
</ol>
<hr>
<h3 id="26-verificar-la-configuracion">2.6. Verificar la configuración<a class="headerlink" href="#26-verificar-la-configuracion" title="Permanent link">¶</a></h3>
<h4 id="prueba-1-verificar-que-firebase-se-inicializa"><strong>Prueba 1: Verificar que Firebase se inicializa</strong><a class="headerlink" href="#prueba-1-verificar-que-firebase-se-inicializa" title="Permanent link">¶</a></h4>
<p><strong>Ubicación:</strong> <code>MyGameStoreApp.kt</code></p>
<div class="language-kotlin highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="k">import</span><span class="w"> </span><span class="nn">com.google.firebase.Firebase</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="k">import</span><span class="w"> </span><span class="nn">com.google.firebase.initialize</span>
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a>
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="kd">class</span><span class="w"> </span><span class="nc">MyGameStoreApp</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Application</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">onCreate</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a><span class="w">        </span><span class="k">super</span><span class="p">.</span><span class="na">onCreate</span><span class="p">()</span>
</span><span id="__span-20-7"><a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a>
</span><span id="__span-20-8"><a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a><span class="w">        </span><span class="c1">// Inicializar Room...</span>
</span><span id="__span-20-9"><a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a><span class="w">        </span><span class="c1">// Inicializar Koin...</span>
</span><span id="__span-20-10"><a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a>
</span><span id="__span-20-11"><a id="__codelineno-20-11" name="__codelineno-20-11" href="#__codelineno-20-11"></a><span class="w">        </span><span class="c1">// 👇 Verificar Firebase (opcional, se inicializa automáticamente)</span>
</span><span id="__span-20-12"><a id="__codelineno-20-12" name="__codelineno-20-12" href="#__codelineno-20-12"></a><span class="w">        </span><span class="n">Firebase</span><span class="p">.</span><span class="na">initialize</span><span class="p">(</span><span class="k">this</span><span class="p">)</span>
</span><span id="__span-20-13"><a id="__codelineno-20-13" name="__codelineno-20-13" href="#__codelineno-20-13"></a><span class="w">        </span><span class="n">println</span><span class="p">(</span><span class="s">"✅ Firebase inicializado correctamente"</span><span class="p">)</span>
</span><span id="__span-20-14"><a id="__codelineno-20-14" name="__codelineno-20-14" href="#__codelineno-20-14"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-20-15"><a id="__codelineno-20-15" name="__codelineno-20-15" href="#__codelineno-20-15"></a><span class="p">}</span>
</span></code></pre></div>
<h4 id="prueba-2-verificar-que-firebaseauth-funciona"><strong>Prueba 2: Verificar que FirebaseAuth funciona</strong><a class="headerlink" href="#prueba-2-verificar-que-firebaseauth-funciona" title="Permanent link">¶</a></h4>
<p>En cualquier pantalla o ViewModel, agrega temporalmente:</p>
<div class="language-kotlin highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="k">import</span><span class="w"> </span><span class="nn">com.google.firebase.auth.FirebaseAuth</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="kd">class</span><span class="w"> </span><span class="nc">LoginViewModel</span><span class="p">(...)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ViewModel</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="w">    </span><span class="k">init</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a><span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">auth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FirebaseAuth</span><span class="p">.</span><span class="na">getInstance</span><span class="p">()</span>
</span><span id="__span-21-6"><a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a><span class="w">        </span><span class="n">println</span><span class="p">(</span><span class="s">"✅ FirebaseAuth disponible: </span><span class="si">${</span><span class="n">auth</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
</span><span id="__span-21-7"><a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a><span class="w">        </span><span class="n">println</span><span class="p">(</span><span class="s">"📧 Usuario actual: </span><span class="si">${</span><span class="n">auth</span><span class="p">.</span><span class="na">currentUser</span><span class="o">?.</span><span class="na">email</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">"</span><span class="n">No</span><span class="w"> </span><span class="n">hay</span><span class="w"> </span><span class="n">usuario</span><span class="s">"</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
</span><span id="__span-21-8"><a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-21-9"><a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a><span class="p">}</span>
</span></code></pre></div>
<p><strong>Ejecuta la app</strong> y revisa el Logcat. Deberías ver:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>✅ Firebase inicializado correctamente
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>✅ FirebaseAuth disponible: true
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a>📧 Usuario actual: No hay usuario
</span></code></pre></div>
<hr>
<h3 id="27-google-servicesjson-en-profundidad">2.7. google-services.json en profundidad<a class="headerlink" href="#27-google-servicesjson-en-profundidad" title="Permanent link">¶</a></h3>
<p>Ahora que Firebase está configurado, entendamos qué hace realmente este archivo.</p>
<h4 id="por-que-es-tan-importante"><strong>¿Por qué es tan importante?</strong><a class="headerlink" href="#por-que-es-tan-importante" title="Permanent link">¶</a></h4>
<p>El archivo <code>google-services.json</code> es el <strong>contrato</strong> entre tu app y Firebase. Sin él:</p>
<ul>
<li>❌ Firebase no sabe a qué proyecto pertenece tu app</li>
<li>❌ Las peticiones serán rechazadas (401 Unauthorized)</li>
<li>❌ Analytics no registrará eventos</li>
<li>❌ Authentication no funcionará</li>
</ul>
<h4 id="contenido-detallado"><strong>Contenido detallado</strong><a class="headerlink" href="#contenido-detallado" title="Permanent link">¶</a></h4>
<div class="language-json highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="p">{</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="w">  </span><span class="nt">"project_info"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a><span class="w">    </span><span class="nt">"project_number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"123456789"</span><span class="p">,</span><span class="w">           </span><span class="c1">// ID numérico del proyecto</span>
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a><span class="w">    </span><span class="nt">"firebase_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://..."</span><span class="p">,</span><span class="w">           </span><span class="c1">// URL de Realtime Database</span>
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a><span class="w">    </span><span class="nt">"project_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"mygamestore-abc123"</span><span class="p">,</span><span class="w">      </span><span class="c1">// ID legible del proyecto</span>
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a><span class="w">    </span><span class="nt">"storage_bucket"</span><span class="p">:</span><span class="w"> </span><span class="s2">"..."</span><span class="w">                  </span><span class="c1">// Bucket de Cloud Storage</span>
</span><span id="__span-23-7"><a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a><span class="w">  </span><span class="p">},</span>
</span><span id="__span-23-8"><a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a><span class="w">  </span><span class="nt">"client"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-23-9"><a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-23-10"><a id="__codelineno-23-10" name="__codelineno-23-10" href="#__codelineno-23-10"></a><span class="w">      </span><span class="nt">"client_info"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-11"><a id="__codelineno-23-11" name="__codelineno-23-11" href="#__codelineno-23-11"></a><span class="w">        </span><span class="nt">"mobilesdk_app_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1:123:android:abc"</span><span class="p">,</span><span class="w">  </span><span class="c1">// ID único de esta app</span>
</span><span id="__span-23-12"><a id="__codelineno-23-12" name="__codelineno-23-12" href="#__codelineno-23-12"></a><span class="w">        </span><span class="nt">"android_client_info"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-13"><a id="__codelineno-23-13" name="__codelineno-23-13" href="#__codelineno-23-13"></a><span class="w">          </span><span class="nt">"package_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"com.pmdm.mygamestore"</span><span class="w">  </span><span class="c1">// Package de tu app</span>
</span><span id="__span-23-14"><a id="__codelineno-23-14" name="__codelineno-23-14" href="#__codelineno-23-14"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-23-15"><a id="__codelineno-23-15" name="__codelineno-23-15" href="#__codelineno-23-15"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-23-16"><a id="__codelineno-23-16" name="__codelineno-23-16" href="#__codelineno-23-16"></a><span class="w">      </span><span class="nt">"oauth_client"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                      </span><span class="c1">// Para Google Sign-In (lo veremos después)</span>
</span><span id="__span-23-17"><a id="__codelineno-23-17" name="__codelineno-23-17" href="#__codelineno-23-17"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-23-18"><a id="__codelineno-23-18" name="__codelineno-23-18" href="#__codelineno-23-18"></a><span class="w">          </span><span class="nt">"client_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"...apps.googleusercontent.com"</span><span class="p">,</span>
</span><span id="__span-23-19"><a id="__codelineno-23-19" name="__codelineno-23-19" href="#__codelineno-23-19"></a><span class="w">          </span><span class="nt">"client_type"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="w">                   </span><span class="c1">// Tipo: Android</span>
</span><span id="__span-23-20"><a id="__codelineno-23-20" name="__codelineno-23-20" href="#__codelineno-23-20"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-23-21"><a id="__codelineno-23-21" name="__codelineno-23-21" href="#__codelineno-23-21"></a><span class="w">      </span><span class="p">],</span>
</span><span id="__span-23-22"><a id="__codelineno-23-22" name="__codelineno-23-22" href="#__codelineno-23-22"></a><span class="w">      </span><span class="nt">"api_key"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">                           </span><span class="c1">// Clave de API</span>
</span><span id="__span-23-23"><a id="__codelineno-23-23" name="__codelineno-23-23" href="#__codelineno-23-23"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-23-24"><a id="__codelineno-23-24" name="__codelineno-23-24" href="#__codelineno-23-24"></a><span class="w">          </span><span class="nt">"current_key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"AIzaSy..."</span><span class="w">        </span><span class="c1">// Clave para autenticar peticiones</span>
</span><span id="__span-23-25"><a id="__codelineno-23-25" name="__codelineno-23-25" href="#__codelineno-23-25"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-23-26"><a id="__codelineno-23-26" name="__codelineno-23-26" href="#__codelineno-23-26"></a><span class="w">      </span><span class="p">],</span>
</span><span id="__span-23-27"><a id="__codelineno-23-27" name="__codelineno-23-27" href="#__codelineno-23-27"></a><span class="w">      </span><span class="nt">"services"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">                          </span><span class="c1">// Servicios habilitados</span>
</span><span id="__span-23-28"><a id="__codelineno-23-28" name="__codelineno-23-28" href="#__codelineno-23-28"></a><span class="w">        </span><span class="nt">"appinvite_service"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">...</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-23-29"><a id="__codelineno-23-29" name="__codelineno-23-29" href="#__codelineno-23-29"></a><span class="w">        </span><span class="nt">"analytics_service"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">...</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-23-30"><a id="__codelineno-23-30" name="__codelineno-23-30" href="#__codelineno-23-30"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-23-31"><a id="__codelineno-23-31" name="__codelineno-23-31" href="#__codelineno-23-31"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-23-32"><a id="__codelineno-23-32" name="__codelineno-23-32" href="#__codelineno-23-32"></a><span class="w">  </span><span class="p">]</span>
</span><span id="__span-23-33"><a id="__codelineno-23-33" name="__codelineno-23-33" href="#__codelineno-23-33"></a><span class="p">}</span>
</span></code></pre></div>
<h4 id="que-hace-el-plugin-google-services"><strong>¿Qué hace el plugin google-services?</strong><a class="headerlink" href="#que-hace-el-plugin-google-services" title="Permanent link">¶</a></h4>
<p>Cuando sincronizas Gradle, el plugin:</p>
<ol>
<li><strong>Lee</strong> <code>google-services.json</code></li>
<li><strong>Extrae</strong> las credenciales</li>
<li><strong>Genera</strong> archivos auxiliares en <code>app/build/generated/</code></li>
<li><strong>Inyecta</strong> las credenciales en tu app en tiempo de compilación</li>
</ol>
<pre class="mermaid"><code>graph LR
    A[google-services.json] --&gt;|Plugin lee| B[google-services.gradle]
    B --&gt;|Genera| C[valores XML en generated/]
    C --&gt;|Se incluyen en| D[APK final]
    D --&gt;|Firebase SDK lee| E[Credenciales en runtime]

    style A fill:#ffd93d
    style D fill:#4d96ff</code></pre>
<hr>
<h4 id="seguridad-debo-subir-google-servicesjson-a-git"><strong>⚠️ Seguridad: ¿Debo subir google-services.json a Git?</strong><a class="headerlink" href="#seguridad-debo-subir-google-servicesjson-a-git" title="Permanent link">¶</a></h4>
<p><strong>Depende del contexto:</strong></p>
<table>
<thead>
<tr>
<th>Escenario</th>
<th>Recomendación</th>
<th>Razón</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Repositorio privado</strong></td>
<td>✅ Sí</td>
<td>Solo tu equipo tiene acceso</td>
</tr>
<tr>
<td><strong>Repositorio público</strong></td>
<td>⚠️ Depende</td>
<td>Las API keys están restringidas por dominio</td>
</tr>
<tr>
<td><strong>Producción con secrets</strong></td>
<td>❌ No</td>
<td>Usar CI/CD para inyectar el archivo</td>
</tr>
</tbody>
</table>
<p><strong>Para este proyecto educativo:</strong></p>
<ul>
<li>✅ <strong>Puedes subirlo</strong> (Firebase tiene protecciones)</li>
<li>⚠️ Pero es buena práctica agregarlo a <code>.gitignore</code> para acostumbrarte</li>
</ul>
<hr>
<h2 id="3-autenticacion-conceptos-y-practica"><strong>3. Autenticación: Conceptos y práctica</strong><a class="headerlink" href="#3-autenticacion-conceptos-y-practica" title="Permanent link">¶</a></h2>
<p>En esta sección implementaremos la autenticación completa con Firebase, integrándola perfectamente en nuestra arquitectura con Koin. Aprenderás tanto los conceptos teóricos como la implementación práctica.</p>
<hr>
<h3 id="31-que-es-la-autenticacion">3.1. ¿Qué es la autenticación?<a class="headerlink" href="#31-que-es-la-autenticacion" title="Permanent link">¶</a></h3>
<p>La <strong>autenticación</strong> es el proceso de verificar la identidad de un usuario. Es la respuesta a la pregunta: <em>"¿Quién eres?"</em></p>
<h4 id="autenticacion-vs-autorizacion"><strong>Autenticación vs Autorización</strong><a class="headerlink" href="#autenticacion-vs-autorizacion" title="Permanent link">¶</a></h4>
<p>Estos dos conceptos suelen confundirse, pero son diferentes:</p>
<table>
<thead>
<tr>
<th>Concepto</th>
<th>Pregunta</th>
<th>Ejemplo</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Autenticación</strong></td>
<td>¿Quién eres?</td>
<td>Login con email/password</td>
</tr>
<tr>
<td><strong>Autorización</strong></td>
<td>¿Qué puedes hacer?</td>
<td>¿Puedes eliminar este juego?</td>
</tr>
</tbody>
</table>
<pre class="mermaid"><code>graph LR
    A[Usuario] --&gt;|1. Credenciales| B[Autenticación]
    B --&gt;|2. Verifica identidad| C{¿Válido?}
    C --&gt;|Sí| D[Token JWT]
    D --&gt;|3. Con token| E[Autorización]
    E --&gt;|4. Verifica permisos| F{¿Permitido?}
    F --&gt;|Sí| G[Acción permitida]
    F --&gt;|No| H[403 Forbidden]
    C --&gt;|No| I[401 Unauthorized]

    style B fill:#4d96ff
    style E fill:#6bcf7f</code></pre>
<p><strong>Ejemplo en nuestra app:</strong></p>
<div class="language-kotlin highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="c1">// Autenticación: ¿Quién eres?</span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="kd">val</span><span class="w"> </span><span class="nv">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">firebaseAuth</span><span class="p">.</span><span class="na">signInWithEmailAndPassword</span><span class="p">(</span><span class="n">email</span><span class="p">,</span><span class="w"> </span><span class="n">password</span><span class="p">)</span>
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a>
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a><span class="c1">// Autorización: ¿Qué puedes hacer?</span>
</span><span id="__span-24-5"><a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">user</span><span class="p">.</span><span class="na">uid</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">game</span><span class="p">.</span><span class="na">ownerId</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-6"><a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a><span class="w">    </span><span class="c1">// Permitir eliminar juego</span>
</span><span id="__span-24-7"><a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-8"><a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a><span class="w">    </span><span class="c1">// Denegar acción</span>
</span><span id="__span-24-9"><a id="__codelineno-24-9" name="__codelineno-24-9" href="#__codelineno-24-9"></a><span class="p">}</span>
</span></code></pre></div>
<hr>
<h4 id="flujo-basico-de-autenticacion"><strong>Flujo básico de autenticación</strong><a class="headerlink" href="#flujo-basico-de-autenticacion" title="Permanent link">¶</a></h4>
<pre class="mermaid"><code>sequenceDiagram
    participant U as Usuario
    participant UI as LoginScreen
    participant VM as ViewModel
    participant Repo as Repository
    participant FB as Firebase Auth
    participant Cloud as Firebase Cloud

    U-&gt;&gt;UI: Ingresa email y password
    UI-&gt;&gt;VM: onLoginClick()
    VM-&gt;&gt;Repo: login(email, password)
    Repo-&gt;&gt;FB: signInWithEmailAndPassword()
    FB-&gt;&gt;Cloud: HTTPS POST /auth/login
    Cloud-&gt;&gt;Cloud: Valida credenciales
    Cloud-&gt;&gt;Cloud: Genera token JWT
    Cloud--&gt;&gt;FB: Token + FirebaseUser
    FB--&gt;&gt;Repo: FirebaseUser
    Repo--&gt;&gt;VM: LoginResult.Success
    VM-&gt;&gt;VM: Guarda sesión
    VM--&gt;&gt;UI: Navega a Home</code></pre>
<hr>
<h4 id="tipos-de-autenticacion-en-firebase"><strong>Tipos de autenticación en Firebase</strong><a class="headerlink" href="#tipos-de-autenticacion-en-firebase" title="Permanent link">¶</a></h4>
<p>Firebase soporta múltiples métodos de autenticación:</p>
<p><strong>1. Email/Password (Tradicional)</strong>
</p><div class="language-kotlin highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="n">firebaseAuth</span><span class="p">.</span><span class="na">createUserWithEmailAndPassword</span><span class="p">(</span><span class="n">email</span><span class="p">,</span><span class="w"> </span><span class="n">password</span><span class="p">)</span><span class="w">  </span><span class="c1">// Registro</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="n">firebaseAuth</span><span class="p">.</span><span class="na">signInWithEmailAndPassword</span><span class="p">(</span><span class="n">email</span><span class="p">,</span><span class="w"> </span><span class="n">password</span><span class="p">)</span><span class="w">      </span><span class="c1">// Login</span>
</span></code></pre></div><p></p>
<p><strong>2. Proveedores OAuth (Google, Facebook, etc.)</strong>
</p><div class="language-kotlin highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="kd">val</span><span class="w"> </span><span class="nv">credential</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GoogleAuthProvider</span><span class="p">.</span><span class="na">getCredential</span><span class="p">(</span><span class="n">idToken</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span>
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a><span class="n">firebaseAuth</span><span class="p">.</span><span class="na">signInWithCredential</span><span class="p">(</span><span class="n">credential</span><span class="p">)</span>
</span></code></pre></div><p></p>
<p><strong>3. Autenticación anónima</strong>
</p><div class="language-kotlin highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="n">firebaseAuth</span><span class="p">.</span><span class="na">signInAnonymously</span><span class="p">()</span><span class="w">  </span><span class="c1">// Usuario temporal</span>
</span></code></pre></div><p></p>
<p><strong>4. Teléfono (SMS)</strong>
</p><div class="language-kotlin highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="n">PhoneAuthProvider</span><span class="p">.</span><span class="na">verifyPhoneNumber</span><span class="p">(</span><span class="n">phoneNumber</span><span class="p">,</span><span class="w"> </span><span class="p">...)</span>
</span></code></pre></div><p></p>
<p><strong>5. Personalizada (Custom tokens)</strong>
</p><div class="language-kotlin highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="n">firebaseAuth</span><span class="p">.</span><span class="na">signInWithCustomToken</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
</span></code></pre></div><p></p>
<p><strong>En este proyecto implementaremos:</strong></p>
<ul>
<li>✅ <strong>Email/Password</strong> (autenticación básica)</li>
<li>✅ <strong>Google Sign-In</strong> (mejor UX, más rápido)</li>
</ul>
<hr>
<h3 id="32-autenticacion-con-emailpassword">3.2. Autenticación con Email/Password<a class="headerlink" href="#32-autenticacion-con-emailpassword" title="Permanent link">¶</a></h3>
<p>Comenzaremos con la autenticación tradicional usando email y contraseña.</p>
<hr>
<h4 id="paso-1-habilitar-emailpassword-en-firebase-console"><strong>Paso 1: Habilitar Email/Password en Firebase Console</strong><a class="headerlink" href="#paso-1-habilitar-emailpassword-en-firebase-console" title="Permanent link">¶</a></h4>
<ol>
<li>Ve a <a href="https://console.firebase.google.com/">Firebase Console</a></li>
<li>Selecciona tu proyecto</li>
<li>En el menú lateral, click en <strong>"Authentication"</strong></li>
<li>Pestaña <strong>"Sign-in method"</strong></li>
<li>Click en <strong>"Email/Password"</strong></li>
<li><strong>Habilitar</strong> el primer switch (Email/Password)</li>
<li>(Opcional) Deja deshabilitado "Email link" por ahora</li>
<li>Click en <strong>"Guardar"</strong></li>
</ol>
<div class="admonition tip">
<p class="admonition-title">Verificar configuración</p>
<p>Deberías ver "Email/Password" con estado <strong>Enabled</strong> en la lista de proveedores.</p>
</div>
<hr>
<h4 id="paso-2-crear-firebaseauthrepositoryimpl"><strong>Paso 2: Crear FirebaseAuthRepositoryImpl</strong><a class="headerlink" href="#paso-2-crear-firebaseauthrepositoryimpl" title="Permanent link">¶</a></h4>
<p>Ahora crearemos la implementación del repositorio que usa Firebase en lugar del mock.</p>
<p><strong>Ubicación:</strong> <code>data/repository/FirebaseAuthRepositoryImpl.kt</code></p>
<div class="language-kotlin highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="k">package</span><span class="w"> </span><span class="nn">com.pmdm.mygamestore.data.repository</span>
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a>
</span><span id="__span-30-3"><a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a><span class="k">import</span><span class="w"> </span><span class="nn">com.google.firebase.auth.FirebaseAuth</span>
</span><span id="__span-30-4"><a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a><span class="k">import</span><span class="w"> </span><span class="nn">com.google.firebase.auth.FirebaseAuthInvalidCredentialsException</span>
</span><span id="__span-30-5"><a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a><span class="k">import</span><span class="w"> </span><span class="nn">com.google.firebase.auth.FirebaseAuthInvalidUserException</span>
</span><span id="__span-30-6"><a id="__codelineno-30-6" name="__codelineno-30-6" href="#__codelineno-30-6"></a><span class="k">import</span><span class="w"> </span><span class="nn">com.google.firebase.auth.FirebaseAuthUserCollisionException</span>
</span><span id="__span-30-7"><a id="__codelineno-30-7" name="__codelineno-30-7" href="#__codelineno-30-7"></a><span class="k">import</span><span class="w"> </span><span class="nn">com.google.firebase.auth.FirebaseAuthWeakPasswordException</span>
</span><span id="__span-30-8"><a id="__codelineno-30-8" name="__codelineno-30-8" href="#__codelineno-30-8"></a><span class="k">import</span><span class="w"> </span><span class="nn">com.pmdm.mygamestore.MyGameStoreApp</span>
</span><span id="__span-30-9"><a id="__codelineno-30-9" name="__codelineno-30-9" href="#__codelineno-30-9"></a><span class="k">import</span><span class="w"> </span><span class="nn">com.pmdm.mygamestore.data.local.entities.UserEntity</span>
</span><span id="__span-30-10"><a id="__codelineno-30-10" name="__codelineno-30-10" href="#__codelineno-30-10"></a><span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.coroutines.tasks.await</span>
</span><span id="__span-30-11"><a id="__codelineno-30-11" name="__codelineno-30-11" href="#__codelineno-30-11"></a>
</span><span id="__span-30-12"><a id="__codelineno-30-12" name="__codelineno-30-12" href="#__codelineno-30-12"></a><span class="cm">/**</span>
</span><span id="__span-30-13"><a id="__codelineno-30-13" name="__codelineno-30-13" href="#__codelineno-30-13"></a><span class="cm"> * Implementación del repositorio de autenticación usando Firebase</span>
</span><span id="__span-30-14"><a id="__codelineno-30-14" name="__codelineno-30-14" href="#__codelineno-30-14"></a><span class="cm"> * </span>
</span><span id="__span-30-15"><a id="__codelineno-30-15" name="__codelineno-30-15" href="#__codelineno-30-15"></a><span class="cm"> * Esta clase encapsula todas las operaciones de autenticación con Firebase,</span>
</span><span id="__span-30-16"><a id="__codelineno-30-16" name="__codelineno-30-16" href="#__codelineno-30-16"></a><span class="cm"> * convirtiendo las respuestas de Firebase en nuestros tipos de dominio</span>
</span><span id="__span-30-17"><a id="__codelineno-30-17" name="__codelineno-30-17" href="#__codelineno-30-17"></a><span class="cm"> * (LoginResult, RegisterResult).</span>
</span><span id="__span-30-18"><a id="__codelineno-30-18" name="__codelineno-30-18" href="#__codelineno-30-18"></a><span class="cm"> * </span>
</span><span id="__span-30-19"><a id="__codelineno-30-19" name="__codelineno-30-19" href="#__codelineno-30-19"></a><span class="cm"> * Ventajas de esta implementación:</span>
</span><span id="__span-30-20"><a id="__codelineno-30-20" name="__codelineno-30-20" href="#__codelineno-30-20"></a><span class="cm"> * - Manejo robusto de errores de Firebase</span>
</span><span id="__span-30-21"><a id="__codelineno-30-21" name="__codelineno-30-21" href="#__codelineno-30-21"></a><span class="cm"> * - Sincronización con Room para persistencia local</span>
</span><span id="__span-30-22"><a id="__codelineno-30-22" name="__codelineno-30-22" href="#__codelineno-30-22"></a><span class="cm"> * - Conversión automática de FirebaseUser a nuestros modelos</span>
</span><span id="__span-30-23"><a id="__codelineno-30-23" name="__codelineno-30-23" href="#__codelineno-30-23"></a><span class="cm"> * - Compatible con la interfaz AuthRepository (DI)</span>
</span><span id="__span-30-24"><a id="__codelineno-30-24" name="__codelineno-30-24" href="#__codelineno-30-24"></a><span class="cm"> */</span>
</span><span id="__span-30-25"><a id="__codelineno-30-25" name="__codelineno-30-25" href="#__codelineno-30-25"></a><span class="kd">class</span><span class="w"> </span><span class="nc">FirebaseAuthRepositoryImpl</span><span class="p">(</span>
</span><span id="__span-30-26"><a id="__codelineno-30-26" name="__codelineno-30-26" href="#__codelineno-30-26"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">firebaseAuth</span><span class="p">:</span><span class="w"> </span><span class="n">FirebaseAuth</span>
</span><span id="__span-30-27"><a id="__codelineno-30-27" name="__codelineno-30-27" href="#__codelineno-30-27"></a><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">AuthRepository</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-28"><a id="__codelineno-30-28" name="__codelineno-30-28" href="#__codelineno-30-28"></a>
</span><span id="__span-30-29"><a id="__codelineno-30-29" name="__codelineno-30-29" href="#__codelineno-30-29"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-30-30"><a id="__codelineno-30-30" name="__codelineno-30-30" href="#__codelineno-30-30"></a><span class="cm">     * Inicia sesión con email y contraseña usando Firebase</span>
</span><span id="__span-30-31"><a id="__codelineno-30-31" name="__codelineno-30-31" href="#__codelineno-30-31"></a><span class="cm">     * </span>
</span><span id="__span-30-32"><a id="__codelineno-30-32" name="__codelineno-30-32" href="#__codelineno-30-32"></a><span class="cm">     * @param username En este caso, usamos el email como username</span>
</span><span id="__span-30-33"><a id="__codelineno-30-33" name="__codelineno-30-33" href="#__codelineno-30-33"></a><span class="cm">     * @param password Contraseña del usuario</span>
</span><span id="__span-30-34"><a id="__codelineno-30-34" name="__codelineno-30-34" href="#__codelineno-30-34"></a><span class="cm">     * @return LoginResult.Success si las credenciales son correctas,</span>
</span><span id="__span-30-35"><a id="__codelineno-30-35" name="__codelineno-30-35" href="#__codelineno-30-35"></a><span class="cm">     *         LoginResult.Error con mensaje específico en caso contrario</span>
</span><span id="__span-30-36"><a id="__codelineno-30-36" name="__codelineno-30-36" href="#__codelineno-30-36"></a><span class="cm">     */</span>
</span><span id="__span-30-37"><a id="__codelineno-30-37" name="__codelineno-30-37" href="#__codelineno-30-37"></a><span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">login</span><span class="p">(</span><span class="n">username</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="n">password</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">):</span><span class="w"> </span><span class="n">LoginResult</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-38"><a id="__codelineno-30-38" name="__codelineno-30-38" href="#__codelineno-30-38"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-39"><a id="__codelineno-30-39" name="__codelineno-30-39" href="#__codelineno-30-39"></a><span class="w">            </span><span class="c1">// Intentar login en Firebase</span>
</span><span id="__span-30-40"><a id="__codelineno-30-40" name="__codelineno-30-40" href="#__codelineno-30-40"></a><span class="w">            </span><span class="kd">val</span><span class="w"> </span><span class="nv">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">firebaseAuth</span><span class="p">.</span><span class="na">signInWithEmailAndPassword</span><span class="p">(</span><span class="n">username</span><span class="p">,</span><span class="w"> </span><span class="n">password</span><span class="p">).</span><span class="na">await</span><span class="p">()</span>
</span><span id="__span-30-41"><a id="__codelineno-30-41" name="__codelineno-30-41" href="#__codelineno-30-41"></a>
</span><span id="__span-30-42"><a id="__codelineno-30-42" name="__codelineno-30-42" href="#__codelineno-30-42"></a><span class="w">            </span><span class="c1">// Verificar que el usuario existe</span>
</span><span id="__span-30-43"><a id="__codelineno-30-43" name="__codelineno-30-43" href="#__codelineno-30-43"></a><span class="w">            </span><span class="kd">val</span><span class="w"> </span><span class="nv">firebaseUser</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">result</span><span class="p">.</span><span class="na">user</span>
</span><span id="__span-30-44"><a id="__codelineno-30-44" name="__codelineno-30-44" href="#__codelineno-30-44"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">firebaseUser</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-45"><a id="__codelineno-30-45" name="__codelineno-30-45" href="#__codelineno-30-45"></a><span class="w">                </span><span class="c1">// Sincronizar usuario en Room para acceso offline</span>
</span><span id="__span-30-46"><a id="__codelineno-30-46" name="__codelineno-30-46" href="#__codelineno-30-46"></a><span class="w">                </span><span class="n">syncUserToRoom</span><span class="p">(</span><span class="n">firebaseUser</span><span class="p">.</span><span class="na">uid</span><span class="p">,</span><span class="w"> </span><span class="n">firebaseUser</span><span class="p">.</span><span class="na">email</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="n">username</span><span class="p">)</span>
</span><span id="__span-30-47"><a id="__codelineno-30-47" name="__codelineno-30-47" href="#__codelineno-30-47"></a>
</span><span id="__span-30-48"><a id="__codelineno-30-48" name="__codelineno-30-48" href="#__codelineno-30-48"></a><span class="w">                </span><span class="n">LoginResult</span><span class="p">.</span><span class="na">Success</span><span class="p">(</span><span class="n">username</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">firebaseUser</span><span class="p">.</span><span class="na">email</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="n">username</span><span class="p">)</span>
</span><span id="__span-30-49"><a id="__codelineno-30-49" name="__codelineno-30-49" href="#__codelineno-30-49"></a><span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-50"><a id="__codelineno-30-50" name="__codelineno-30-50" href="#__codelineno-30-50"></a><span class="w">                </span><span class="n">LoginResult</span><span class="p">.</span><span class="na">Error</span><span class="p">(</span><span class="s">"Authentication failed: User is null"</span><span class="p">)</span>
</span><span id="__span-30-51"><a id="__codelineno-30-51" name="__codelineno-30-51" href="#__codelineno-30-51"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-30-52"><a id="__codelineno-30-52" name="__codelineno-30-52" href="#__codelineno-30-52"></a>
</span><span id="__span-30-53"><a id="__codelineno-30-53" name="__codelineno-30-53" href="#__codelineno-30-53"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">:</span><span class="w"> </span><span class="n">FirebaseAuthInvalidUserException</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-54"><a id="__codelineno-30-54" name="__codelineno-30-54" href="#__codelineno-30-54"></a><span class="w">            </span><span class="c1">// Usuario no existe</span>
</span><span id="__span-30-55"><a id="__codelineno-30-55" name="__codelineno-30-55" href="#__codelineno-30-55"></a><span class="w">            </span><span class="n">LoginResult</span><span class="p">.</span><span class="na">Error</span><span class="p">(</span><span class="s">"No account found with this email"</span><span class="p">)</span>
</span><span id="__span-30-56"><a id="__codelineno-30-56" name="__codelineno-30-56" href="#__codelineno-30-56"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">:</span><span class="w"> </span><span class="n">FirebaseAuthInvalidCredentialsException</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-57"><a id="__codelineno-30-57" name="__codelineno-30-57" href="#__codelineno-30-57"></a><span class="w">            </span><span class="c1">// Contraseña incorrecta</span>
</span><span id="__span-30-58"><a id="__codelineno-30-58" name="__codelineno-30-58" href="#__codelineno-30-58"></a><span class="w">            </span><span class="n">LoginResult</span><span class="p">.</span><span class="na">Error</span><span class="p">(</span><span class="s">"Invalid password"</span><span class="p">)</span>
</span><span id="__span-30-59"><a id="__codelineno-30-59" name="__codelineno-30-59" href="#__codelineno-30-59"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">:</span><span class="w"> </span><span class="n">Exception</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-60"><a id="__codelineno-30-60" name="__codelineno-30-60" href="#__codelineno-30-60"></a><span class="w">            </span><span class="c1">// Otros errores (red, etc.)</span>
</span><span id="__span-30-61"><a id="__codelineno-30-61" name="__codelineno-30-61" href="#__codelineno-30-61"></a><span class="w">            </span><span class="n">LoginResult</span><span class="p">.</span><span class="na">Error</span><span class="p">(</span><span class="s">"Login failed: </span><span class="si">${</span><span class="n">e</span><span class="p">.</span><span class="na">message</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
</span><span id="__span-30-62"><a id="__codelineno-30-62" name="__codelineno-30-62" href="#__codelineno-30-62"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-30-63"><a id="__codelineno-30-63" name="__codelineno-30-63" href="#__codelineno-30-63"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-30-64"><a id="__codelineno-30-64" name="__codelineno-30-64" href="#__codelineno-30-64"></a>
</span><span id="__span-30-65"><a id="__codelineno-30-65" name="__codelineno-30-65" href="#__codelineno-30-65"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-30-66"><a id="__codelineno-30-66" name="__codelineno-30-66" href="#__codelineno-30-66"></a><span class="cm">     * Registra un nuevo usuario con email y contraseña</span>
</span><span id="__span-30-67"><a id="__codelineno-30-67" name="__codelineno-30-67" href="#__codelineno-30-67"></a><span class="cm">     * </span>
</span><span id="__span-30-68"><a id="__codelineno-30-68" name="__codelineno-30-68" href="#__codelineno-30-68"></a><span class="cm">     * @param username Email del usuario</span>
</span><span id="__span-30-69"><a id="__codelineno-30-69" name="__codelineno-30-69" href="#__codelineno-30-69"></a><span class="cm">     * @param email Email del usuario (mismo que username en este caso)</span>
</span><span id="__span-30-70"><a id="__codelineno-30-70" name="__codelineno-30-70" href="#__codelineno-30-70"></a><span class="cm">     * @param password Contraseña del usuario</span>
</span><span id="__span-30-71"><a id="__codelineno-30-71" name="__codelineno-30-71" href="#__codelineno-30-71"></a><span class="cm">     * @return RegisterResult.Success si el registro es exitoso,</span>
</span><span id="__span-30-72"><a id="__codelineno-30-72" name="__codelineno-30-72" href="#__codelineno-30-72"></a><span class="cm">     *         RegisterResult.Error con mensaje específico en caso contrario</span>
</span><span id="__span-30-73"><a id="__codelineno-30-73" name="__codelineno-30-73" href="#__codelineno-30-73"></a><span class="cm">     */</span>
</span><span id="__span-30-74"><a id="__codelineno-30-74" name="__codelineno-30-74" href="#__codelineno-30-74"></a><span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">register</span><span class="p">(</span>
</span><span id="__span-30-75"><a id="__codelineno-30-75" name="__codelineno-30-75" href="#__codelineno-30-75"></a><span class="w">        </span><span class="n">username</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
</span><span id="__span-30-76"><a id="__codelineno-30-76" name="__codelineno-30-76" href="#__codelineno-30-76"></a><span class="w">        </span><span class="n">email</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
</span><span id="__span-30-77"><a id="__codelineno-30-77" name="__codelineno-30-77" href="#__codelineno-30-77"></a><span class="w">        </span><span class="n">password</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span>
</span><span id="__span-30-78"><a id="__codelineno-30-78" name="__codelineno-30-78" href="#__codelineno-30-78"></a><span class="w">    </span><span class="p">):</span><span class="w"> </span><span class="n">RegisterResult</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-79"><a id="__codelineno-30-79" name="__codelineno-30-79" href="#__codelineno-30-79"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-80"><a id="__codelineno-30-80" name="__codelineno-30-80" href="#__codelineno-30-80"></a><span class="w">            </span><span class="c1">// Crear usuario en Firebase</span>
</span><span id="__span-30-81"><a id="__codelineno-30-81" name="__codelineno-30-81" href="#__codelineno-30-81"></a><span class="w">            </span><span class="kd">val</span><span class="w"> </span><span class="nv">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">firebaseAuth</span><span class="p">.</span><span class="na">createUserWithEmailAndPassword</span><span class="p">(</span><span class="n">email</span><span class="p">,</span><span class="w"> </span><span class="n">password</span><span class="p">).</span><span class="na">await</span><span class="p">()</span>
</span><span id="__span-30-82"><a id="__codelineno-30-82" name="__codelineno-30-82" href="#__codelineno-30-82"></a>
</span><span id="__span-30-83"><a id="__codelineno-30-83" name="__codelineno-30-83" href="#__codelineno-30-83"></a><span class="w">            </span><span class="kd">val</span><span class="w"> </span><span class="nv">firebaseUser</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">result</span><span class="p">.</span><span class="na">user</span>
</span><span id="__span-30-84"><a id="__codelineno-30-84" name="__codelineno-30-84" href="#__codelineno-30-84"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">firebaseUser</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-85"><a id="__codelineno-30-85" name="__codelineno-30-85" href="#__codelineno-30-85"></a><span class="w">                </span><span class="c1">// Sincronizar en Room</span>
</span><span id="__span-30-86"><a id="__codelineno-30-86" name="__codelineno-30-86" href="#__codelineno-30-86"></a><span class="w">                </span><span class="n">syncUserToRoom</span><span class="p">(</span><span class="n">firebaseUser</span><span class="p">.</span><span class="na">uid</span><span class="p">,</span><span class="w"> </span><span class="n">email</span><span class="p">)</span>
</span><span id="__span-30-87"><a id="__codelineno-30-87" name="__codelineno-30-87" href="#__codelineno-30-87"></a>
</span><span id="__span-30-88"><a id="__codelineno-30-88" name="__codelineno-30-88" href="#__codelineno-30-88"></a><span class="w">                </span><span class="c1">// (Opcional) Enviar email de verificación</span>
</span><span id="__span-30-89"><a id="__codelineno-30-89" name="__codelineno-30-89" href="#__codelineno-30-89"></a><span class="w">                </span><span class="n">firebaseUser</span><span class="p">.</span><span class="na">sendEmailVerification</span><span class="p">().</span><span class="na">await</span><span class="p">()</span>
</span><span id="__span-30-90"><a id="__codelineno-30-90" name="__codelineno-30-90" href="#__codelineno-30-90"></a>
</span><span id="__span-30-91"><a id="__codelineno-30-91" name="__codelineno-30-91" href="#__codelineno-30-91"></a><span class="w">                </span><span class="n">RegisterResult</span><span class="p">.</span><span class="na">Success</span><span class="p">(</span><span class="n">username</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">email</span><span class="p">)</span>
</span><span id="__span-30-92"><a id="__codelineno-30-92" name="__codelineno-30-92" href="#__codelineno-30-92"></a><span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-93"><a id="__codelineno-30-93" name="__codelineno-30-93" href="#__codelineno-30-93"></a><span class="w">                </span><span class="n">RegisterResult</span><span class="p">.</span><span class="na">Error</span><span class="p">(</span><span class="s">"Registration failed: User is null"</span><span class="p">)</span>
</span><span id="__span-30-94"><a id="__codelineno-30-94" name="__codelineno-30-94" href="#__codelineno-30-94"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-30-95"><a id="__codelineno-30-95" name="__codelineno-30-95" href="#__codelineno-30-95"></a>
</span><span id="__span-30-96"><a id="__codelineno-30-96" name="__codelineno-30-96" href="#__codelineno-30-96"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">:</span><span class="w"> </span><span class="n">FirebaseAuthWeakPasswordException</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-97"><a id="__codelineno-30-97" name="__codelineno-30-97" href="#__codelineno-30-97"></a><span class="w">            </span><span class="c1">// Contraseña débil (menos de 6 caracteres)</span>
</span><span id="__span-30-98"><a id="__codelineno-30-98" name="__codelineno-30-98" href="#__codelineno-30-98"></a><span class="w">            </span><span class="n">RegisterResult</span><span class="p">.</span><span class="na">Error</span><span class="p">(</span><span class="s">"Password should be at least 6 characters"</span><span class="p">)</span>
</span><span id="__span-30-99"><a id="__codelineno-30-99" name="__codelineno-30-99" href="#__codelineno-30-99"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">:</span><span class="w"> </span><span class="n">FirebaseAuthInvalidCredentialsException</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-100"><a id="__codelineno-30-100" name="__codelineno-30-100" href="#__codelineno-30-100"></a><span class="w">            </span><span class="c1">// Email inválido</span>
</span><span id="__span-30-101"><a id="__codelineno-30-101" name="__codelineno-30-101" href="#__codelineno-30-101"></a><span class="w">            </span><span class="n">RegisterResult</span><span class="p">.</span><span class="na">Error</span><span class="p">(</span><span class="s">"Invalid email format"</span><span class="p">)</span>
</span><span id="__span-30-102"><a id="__codelineno-30-102" name="__codelineno-30-102" href="#__codelineno-30-102"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">:</span><span class="w"> </span><span class="n">FirebaseAuthUserCollisionException</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-103"><a id="__codelineno-30-103" name="__codelineno-30-103" href="#__codelineno-30-103"></a><span class="w">            </span><span class="c1">// Email ya registrado</span>
</span><span id="__span-30-104"><a id="__codelineno-30-104" name="__codelineno-30-104" href="#__codelineno-30-104"></a><span class="w">            </span><span class="n">RegisterResult</span><span class="p">.</span><span class="na">Error</span><span class="p">(</span><span class="s">"An account already exists with this email"</span><span class="p">)</span>
</span><span id="__span-30-105"><a id="__codelineno-30-105" name="__codelineno-30-105" href="#__codelineno-30-105"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">:</span><span class="w"> </span><span class="n">Exception</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-106"><a id="__codelineno-30-106" name="__codelineno-30-106" href="#__codelineno-30-106"></a><span class="w">            </span><span class="n">RegisterResult</span><span class="p">.</span><span class="na">Error</span><span class="p">(</span><span class="s">"Registration failed: </span><span class="si">${</span><span class="n">e</span><span class="p">.</span><span class="na">message</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
</span><span id="__span-30-107"><a id="__codelineno-30-107" name="__codelineno-30-107" href="#__codelineno-30-107"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-30-108"><a id="__codelineno-30-108" name="__codelineno-30-108" href="#__codelineno-30-108"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-30-109"><a id="__codelineno-30-109" name="__codelineno-30-109" href="#__codelineno-30-109"></a>
</span><span id="__span-30-110"><a id="__codelineno-30-110" name="__codelineno-30-110" href="#__codelineno-30-110"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-30-111"><a id="__codelineno-30-111" name="__codelineno-30-111" href="#__codelineno-30-111"></a><span class="cm">     * Sincroniza el usuario de Firebase con Room</span>
</span><span id="__span-30-112"><a id="__codelineno-30-112" name="__codelineno-30-112" href="#__codelineno-30-112"></a><span class="cm">     * </span>
</span><span id="__span-30-113"><a id="__codelineno-30-113" name="__codelineno-30-113" href="#__codelineno-30-113"></a><span class="cm">     * Esto permite:</span>
</span><span id="__span-30-114"><a id="__codelineno-30-114" name="__codelineno-30-114" href="#__codelineno-30-114"></a><span class="cm">     * - Acceso offline a información básica del usuario</span>
</span><span id="__span-30-115"><a id="__codelineno-30-115" name="__codelineno-30-115" href="#__codelineno-30-115"></a><span class="cm">     * - Relaciones con otras entidades (Library, Notes, etc.)</span>
</span><span id="__span-30-116"><a id="__codelineno-30-116" name="__codelineno-30-116" href="#__codelineno-30-116"></a><span class="cm">     * - Consistencia entre Firebase Auth y nuestra base de datos local</span>
</span><span id="__span-30-117"><a id="__codelineno-30-117" name="__codelineno-30-117" href="#__codelineno-30-117"></a><span class="cm">     * </span>
</span><span id="__span-30-118"><a id="__codelineno-30-118" name="__codelineno-30-118" href="#__codelineno-30-118"></a><span class="cm">     * @param userId UID de Firebase</span>
</span><span id="__span-30-119"><a id="__codelineno-30-119" name="__codelineno-30-119" href="#__codelineno-30-119"></a><span class="cm">     * @param email Email del usuario</span>
</span><span id="__span-30-120"><a id="__codelineno-30-120" name="__codelineno-30-120" href="#__codelineno-30-120"></a><span class="cm">     */</span>
</span><span id="__span-30-121"><a id="__codelineno-30-121" name="__codelineno-30-121" href="#__codelineno-30-121"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">syncUserToRoom</span><span class="p">(</span><span class="n">userId</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="n">email</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-122"><a id="__codelineno-30-122" name="__codelineno-30-122" href="#__codelineno-30-122"></a><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-123"><a id="__codelineno-30-123" name="__codelineno-30-123" href="#__codelineno-30-123"></a><span class="w">            </span><span class="kd">val</span><span class="w"> </span><span class="nv">userEntity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UserEntity</span><span class="p">(</span>
</span><span id="__span-30-124"><a id="__codelineno-30-124" name="__codelineno-30-124" href="#__codelineno-30-124"></a><span class="w">                </span><span class="n">username</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">email</span><span class="p">,</span><span class="w">  </span><span class="c1">// Usamos email como username</span>
</span><span id="__span-30-125"><a id="__codelineno-30-125" name="__codelineno-30-125" href="#__codelineno-30-125"></a><span class="w">                </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">email</span><span class="p">.</span><span class="na">substringBefore</span><span class="p">(</span><span class="s">"@"</span><span class="p">),</span><span class="w">  </span><span class="c1">// Nombre por defecto</span>
</span><span id="__span-30-126"><a id="__codelineno-30-126" name="__codelineno-30-126" href="#__codelineno-30-126"></a><span class="w">                </span><span class="n">email</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">email</span><span class="p">,</span>
</span><span id="__span-30-127"><a id="__codelineno-30-127" name="__codelineno-30-127" href="#__codelineno-30-127"></a><span class="w">                </span><span class="n">avatarUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
</span><span id="__span-30-128"><a id="__codelineno-30-128" name="__codelineno-30-128" href="#__codelineno-30-128"></a><span class="w">                </span><span class="n">bio</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span>
</span><span id="__span-30-129"><a id="__codelineno-30-129" name="__codelineno-30-129" href="#__codelineno-30-129"></a><span class="w">            </span><span class="p">)</span>
</span><span id="__span-30-130"><a id="__codelineno-30-130" name="__codelineno-30-130" href="#__codelineno-30-130"></a>
</span><span id="__span-30-131"><a id="__codelineno-30-131" name="__codelineno-30-131" href="#__codelineno-30-131"></a><span class="w">            </span><span class="n">MyGameStoreApp</span><span class="p">.</span><span class="na">database</span><span class="p">.</span><span class="na">userDao</span><span class="p">().</span><span class="na">insertUser</span><span class="p">(</span><span class="n">userEntity</span><span class="p">)</span>
</span><span id="__span-30-132"><a id="__codelineno-30-132" name="__codelineno-30-132" href="#__codelineno-30-132"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">:</span><span class="w"> </span><span class="n">Exception</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-133"><a id="__codelineno-30-133" name="__codelineno-30-133" href="#__codelineno-30-133"></a><span class="w">            </span><span class="c1">// Log error pero no fallar el login</span>
</span><span id="__span-30-134"><a id="__codelineno-30-134" name="__codelineno-30-134" href="#__codelineno-30-134"></a><span class="w">            </span><span class="n">println</span><span class="p">(</span><span class="s">"⚠️ Error syncing user to Room: </span><span class="si">${</span><span class="n">e</span><span class="p">.</span><span class="na">message</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
</span><span id="__span-30-135"><a id="__codelineno-30-135" name="__codelineno-30-135" href="#__codelineno-30-135"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-30-136"><a id="__codelineno-30-136" name="__codelineno-30-136" href="#__codelineno-30-136"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-30-137"><a id="__codelineno-30-137" name="__codelineno-30-137" href="#__codelineno-30-137"></a><span class="p">}</span>
</span></code></pre></div>
<p><strong>Conceptos clave del código:</strong></p>
<ol>
<li>
<p><strong>suspend fun + await()</strong>
</p><div class="language-kotlin highlight"><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a><span class="c1">// Firebase devuelve Tasks (asíncronas)</span>
</span><span id="__span-31-2"><a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a><span class="kd">val</span><span class="w"> </span><span class="nv">task</span><span class="p">:</span><span class="w"> </span><span class="n">Task</span><span class="o">&lt;</span><span class="n">AuthResult</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">firebaseAuth</span><span class="p">.</span><span class="na">signInWithEmailAndPassword</span><span class="p">(</span><span class="n">email</span><span class="p">,</span><span class="w"> </span><span class="n">password</span><span class="p">)</span>
</span><span id="__span-31-3"><a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a>
</span><span id="__span-31-4"><a id="__codelineno-31-4" name="__codelineno-31-4" href="#__codelineno-31-4"></a><span class="c1">// await() convierte Task en suspend function</span>
</span><span id="__span-31-5"><a id="__codelineno-31-5" name="__codelineno-31-5" href="#__codelineno-31-5"></a><span class="kd">val</span><span class="w"> </span><span class="nv">result</span><span class="p">:</span><span class="w"> </span><span class="n">AuthResult</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">task</span><span class="p">.</span><span class="na">await</span><span class="p">()</span>
</span></code></pre></div><p></p>
</li>
<li>
<p><strong>Manejo específico de excepciones de Firebase</strong>
</p><div class="language-kotlin highlight"><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">:</span><span class="w"> </span><span class="n">FirebaseAuthInvalidUserException</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-2"><a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a><span class="w">    </span><span class="c1">// Usuario no existe</span>
</span><span id="__span-32-3"><a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a><span class="p">}</span>
</span><span id="__span-32-4"><a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">:</span><span class="w"> </span><span class="n">FirebaseAuthInvalidCredentialsException</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-5"><a id="__codelineno-32-5" name="__codelineno-32-5" href="#__codelineno-32-5"></a><span class="w">    </span><span class="c1">// Contraseña incorrecta o email inválido</span>
</span><span id="__span-32-6"><a id="__codelineno-32-6" name="__codelineno-32-6" href="#__codelineno-32-6"></a><span class="p">}</span>
</span><span id="__span-32-7"><a id="__codelineno-32-7" name="__codelineno-32-7" href="#__codelineno-32-7"></a><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">:</span><span class="w"> </span><span class="n">FirebaseAuthWeakPasswordException</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-8"><a id="__codelineno-32-8" name="__codelineno-32-8" href="#__codelineno-32-8"></a><span class="w">    </span><span class="c1">// Contraseña débil (&lt; 6 caracteres)</span>
</span><span id="__span-32-9"><a id="__codelineno-32-9" name="__codelineno-32-9" href="#__codelineno-32-9"></a><span class="p">}</span>
</span></code></pre></div><p></p>
</li>
<li>
<p><strong>Sincronización con Room</strong>
</p><div class="language-kotlin highlight"><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a><span class="c1">// Guardar usuario en Room para:</span>
</span><span id="__span-33-2"><a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a><span class="c1">// - Acceso offline</span>
</span><span id="__span-33-3"><a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a><span class="c1">// - Relaciones con otras entidades (Foreign Keys)</span>
</span><span id="__span-33-4"><a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a><span class="n">MyGameStoreApp</span><span class="p">.</span><span class="na">database</span><span class="p">.</span><span class="na">userDao</span><span class="p">().</span><span class="na">insertUser</span><span class="p">(</span><span class="n">userEntity</span><span class="p">)</span>
</span></code></pre></div><p></p>
</li>
</ol>
<hr>
<h4 id="paso-3-actualizar-datamodule-con-firebase"><strong>Paso 3: Actualizar DataModule con Firebase</strong><a class="headerlink" href="#paso-3-actualizar-datamodule-con-firebase" title="Permanent link">¶</a></h4>
<p>Ahora configuramos Koin para usar Firebase en lugar del mock.</p>
<p><strong>Ubicación:</strong> <code>di/DataModule.kt</code></p>
<div class="language-kotlin highlight"><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="k">package</span><span class="w"> </span><span class="nn">com.pmdm.mygamestore.di</span>
</span><span id="__span-34-2"><a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a>
</span><span id="__span-34-3"><a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a><span class="k">import</span><span class="w"> </span><span class="nn">com.google.firebase.auth.FirebaseAuth</span>
</span><span id="__span-34-4"><a id="__codelineno-34-4" name="__codelineno-34-4" href="#__codelineno-34-4"></a><span class="k">import</span><span class="w"> </span><span class="nn">com.pmdm.mygamestore.MyGameStoreApp</span>
</span><span id="__span-34-5"><a id="__codelineno-34-5" name="__codelineno-34-5" href="#__codelineno-34-5"></a><span class="k">import</span><span class="w"> </span><span class="nn">com.pmdm.mygamestore.data.local.SessionManager</span>
</span><span id="__span-34-6"><a id="__codelineno-34-6" name="__codelineno-34-6" href="#__codelineno-34-6"></a><span class="k">import</span><span class="w"> </span><span class="nn">com.pmdm.mygamestore.data.local.SessionManagerImpl</span>
</span><span id="__span-34-7"><a id="__codelineno-34-7" name="__codelineno-34-7" href="#__codelineno-34-7"></a><span class="k">import</span><span class="w"> </span><span class="nn">com.pmdm.mygamestore.data.repository.AuthRepository</span>
</span><span id="__span-34-8"><a id="__codelineno-34-8" name="__codelineno-34-8" href="#__codelineno-34-8"></a><span class="k">import</span><span class="w"> </span><span class="nn">com.pmdm.mygamestore.data.repository.FirebaseAuthRepositoryImpl</span><span class="w">  </span><span class="c1">// 👈 Import nuevo</span>
</span><span id="__span-34-9"><a id="__codelineno-34-9" name="__codelineno-34-9" href="#__codelineno-34-9"></a><span class="k">import</span><span class="w"> </span><span class="nn">com.pmdm.mygamestore.data.repository.GamesRepository</span>
</span><span id="__span-34-10"><a id="__codelineno-34-10" name="__codelineno-34-10" href="#__codelineno-34-10"></a><span class="k">import</span><span class="w"> </span><span class="nn">com.pmdm.mygamestore.data.repository.MockGamesRepositoryImpl</span>
</span><span id="__span-34-11"><a id="__codelineno-34-11" name="__codelineno-34-11" href="#__codelineno-34-11"></a><span class="k">import</span><span class="w"> </span><span class="nn">org.koin.core.module.dsl.singleOf</span>
</span><span id="__span-34-12"><a id="__codelineno-34-12" name="__codelineno-34-12" href="#__codelineno-34-12"></a><span class="k">import</span><span class="w"> </span><span class="nn">org.koin.dsl.bind</span>
</span><span id="__span-34-13"><a id="__codelineno-34-13" name="__codelineno-34-13" href="#__codelineno-34-13"></a><span class="k">import</span><span class="w"> </span><span class="nn">org.koin.dsl.module</span>
</span><span id="__span-34-14"><a id="__codelineno-34-14" name="__codelineno-34-14" href="#__codelineno-34-14"></a>
</span><span id="__span-34-15"><a id="__codelineno-34-15" name="__codelineno-34-15" href="#__codelineno-34-15"></a><span class="kd">val</span><span class="w"> </span><span class="nv">dataModule</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">module</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-16"><a id="__codelineno-34-16" name="__codelineno-34-16" href="#__codelineno-34-16"></a>
</span><span id="__span-34-17"><a id="__codelineno-34-17" name="__codelineno-34-17" href="#__codelineno-34-17"></a><span class="w">    </span><span class="c1">// Database (Singleton)</span>
</span><span id="__span-34-18"><a id="__codelineno-34-18" name="__codelineno-34-18" href="#__codelineno-34-18"></a><span class="w">    </span><span class="n">single</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">MyGameStoreApp</span><span class="p">.</span><span class="na">database</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-34-19"><a id="__codelineno-34-19" name="__codelineno-34-19" href="#__codelineno-34-19"></a>
</span><span id="__span-34-20"><a id="__codelineno-34-20" name="__codelineno-34-20" href="#__codelineno-34-20"></a><span class="w">    </span><span class="c1">// 🆕 Firebase Auth (Singleton)</span>
</span><span id="__span-34-21"><a id="__codelineno-34-21" name="__codelineno-34-21" href="#__codelineno-34-21"></a><span class="w">    </span><span class="n">single</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">FirebaseAuth</span><span class="p">.</span><span class="na">getInstance</span><span class="p">()</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-34-22"><a id="__codelineno-34-22" name="__codelineno-34-22" href="#__codelineno-34-22"></a>
</span><span id="__span-34-23"><a id="__codelineno-34-23" name="__codelineno-34-23" href="#__codelineno-34-23"></a><span class="w">    </span><span class="c1">// SessionManager (Singleton)</span>
</span><span id="__span-34-24"><a id="__codelineno-34-24" name="__codelineno-34-24" href="#__codelineno-34-24"></a><span class="w">    </span><span class="n">singleOf</span><span class="p">(</span><span class="o">::</span><span class="n">SessionManagerImpl</span><span class="p">)</span><span class="w"> </span><span class="n">bind</span><span class="w"> </span><span class="n">SessionManager</span><span class="o">::</span><span class="kd">class</span>
</span><span id="__span-34-25"><a id="__codelineno-34-25" name="__codelineno-34-25" href="#__codelineno-34-25"></a>
</span><span id="__span-34-26"><a id="__codelineno-34-26" name="__codelineno-34-26" href="#__codelineno-34-26"></a><span class="w">    </span><span class="err">// 🔄 </span><span class="nc">AuthRepository</span><span class="p">:</span><span class="w"> </span><span class="n">Cambiar</span><span class="w"> </span><span class="n">de</span><span class="w"> </span><span class="n">Mock</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">Firebase</span>
</span><span id="__span-34-27"><a id="__codelineno-34-27" name="__codelineno-34-27" href="#__codelineno-34-27"></a><span class="w">    </span><span class="n">singleOf</span><span class="p">(</span><span class="o">::</span><span class="n">FirebaseAuthRepositoryImpl</span><span class="p">)</span><span class="w"> </span><span class="n">bind</span><span class="w"> </span><span class="n">AuthRepository</span><span class="o">::</span><span class="kd">class</span>
</span><span id="__span-34-28"><a id="__codelineno-34-28" name="__codelineno-34-28" href="#__codelineno-34-28"></a>
</span><span id="__span-34-29"><a id="__codelineno-34-29" name="__codelineno-34-29" href="#__codelineno-34-29"></a><span class="w">    </span><span class="err">// </span><span class="nc">GamesRepository</span><span class="w"> </span><span class="p">(</span><span class="n">Mock</span><span class="w"> </span><span class="n">por</span><span class="w"> </span><span class="n">ahora</span><span class="p">)</span>
</span><span id="__span-34-30"><a id="__codelineno-34-30" name="__codelineno-34-30" href="#__codelineno-34-30"></a><span class="w">    </span><span class="n">singleOf</span><span class="p">(</span><span class="o">::</span><span class="n">MockGamesRepositoryImpl</span><span class="p">)</span><span class="w"> </span><span class="n">bind</span><span class="w"> </span><span class="n">GamesRepository</span><span class="o">::</span><span class="kd">class</span>
</span><span id="__span-34-31"><a id="__codelineno-34-31" name="__codelineno-34-31" href="#__codelineno-34-31"></a><span class="err">}</span>
</span></code></pre></div>
<p><strong>¡Observa la magia de la DI!</strong></p>
<div class="language-kotlin highlight"><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a><span class="c1">// ❌ Antes (Mock)</span>
</span><span id="__span-35-2"><a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a><span class="n">singleOf</span><span class="p">(</span><span class="o">::</span><span class="n">AuthRepositoryImpl</span><span class="p">)</span><span class="w"> </span><span class="n">bind</span><span class="w"> </span><span class="n">AuthRepository</span><span class="o">::</span><span class="kd">class</span>
</span><span id="__span-35-3"><a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a>
</span><span id="__span-35-4"><a id="__codelineno-35-4" name="__codelineno-35-4" href="#__codelineno-35-4"></a><span class="err">// ✅ </span><span class="nc">Ahora</span><span class="w"> </span><span class="p">(</span><span class="n">Firebase</span><span class="p">)</span>
</span><span id="__span-35-5"><a id="__codelineno-35-5" name="__codelineno-35-5" href="#__codelineno-35-5"></a><span class="n">singleOf</span><span class="p">(</span><span class="o">::</span><span class="n">FirebaseAuthRepositoryImpl</span><span class="p">)</span><span class="w"> </span><span class="n">bind</span><span class="w"> </span><span class="n">AuthRepository</span><span class="o">::</span><span class="kd">class</span>
</span></code></pre></div>
<p><strong>¿Qué cambió en la app?</strong></p>
<ul>
<li>✅ <strong>LoginViewModel</strong>: Sin cambios</li>
<li>✅ <strong>RegisterViewModel</strong>: Sin cambios</li>
<li>✅ <strong>LoginScreen</strong>: Sin cambios</li>
<li>✅ <strong>RegisterScreen</strong>: Sin cambios</li>
</ul>
<p><strong>Solo cambiamos UNA línea y toda la app usa Firebase.</strong> 🎉</p>
<hr>
<h4 id="paso-4-testing-del-flujo-completo"><strong>Paso 4: Testing del flujo completo</strong><a class="headerlink" href="#paso-4-testing-del-flujo-completo" title="Permanent link">¶</a></h4>
<p>Ahora vamos a probar que todo funciona.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:4"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio"><input id="__tabbed_2_2" name="__tabbed_2" type="radio"><input id="__tabbed_2_3" name="__tabbed_2" type="radio"><input id="__tabbed_2_4" name="__tabbed_2" type="radio"><div class="tabbed-labels"><label for="__tabbed_2_1">Escenario 1: Registro de nuevo usuario</label><label for="__tabbed_2_2">Escenario 2: Login con usuario existente</label><label for="__tabbed_2_3">Escenario 3: Error - Contraseña incorrecta</label><label for="__tabbed_2_4">Escenario 4: Error - Usuario no existe</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<ol>
<li>Abre la app</li>
<li>Ve a RegisterScreen</li>
<li>Ingresa:</li>
</ol>
<ul>
<li>Email: <code>test@example.com</code></li>
<li>Password: <code>password123</code></li>
<li>Confirm Password: <code>password123</code></li>
</ul>
<ol start="4">
<li>Click en "Register"</li>
<li><strong>Resultado esperado:</strong></li>
</ol>
<ul>
<li>Loading indicator aparece</li>
<li>Se crea el usuario en Firebase</li>
<li>Navegas a HomeScreen</li>
</ul>
<p><strong>Verificar en Firebase Console:</strong></p>
<ol>
<li>Ve a Authentication → Users</li>
<li>Deberías ver el usuario <code>test@example.com</code></li>
<li>Click en el usuario para ver detalles</li>
</ol>
</div>
<div class="tabbed-block">
<ol>
<li>Cierra la app completamente</li>
<li>Abre la app de nuevo</li>
<li>Ve a LoginScreen</li>
<li>
<p>Ingresa:</p>
<ul>
<li>Email: <code>test@example.com</code></li>
<li>Password: <code>password123</code></li>
</ul>
</li>
<li>
<p>Click en "Login"</p>
</li>
<li>
<p><strong>Resultado esperado:</strong></p>
<ul>
<li>Loading indicator</li>
<li>Login exitoso</li>
<li>Navegas a HomeScreen</li>
</ul>
</li>
</ol>
</div>
<div class="tabbed-block">
<ol>
<li>Ve a LoginScreen</li>
<li>
<p>Ingresa:</p>
<ul>
<li>Email: <code>test@example.com</code></li>
<li>Password: <code>wrongpassword</code></li>
</ul>
</li>
<li>
<p>Click en "Login"</p>
</li>
<li>
<p><strong>Resultado esperado:</strong></p>
<ul>
<li>Snackbar con mensaje: "Invalid password"</li>
<li>No navegas</li>
<li>Puedes intentar de nuevo</li>
</ul>
</li>
</ol>
</div>
<div class="tabbed-block">
<ol>
<li>LoginScreen</li>
<li>
<p>Ingresa:</p>
<ul>
<li>Email: <code>noexiste@example.com</code></li>
<li>Password: <code>password123</code></li>
</ul>
</li>
<li>
<p><strong>Resultado esperado:</strong></p>
<ul>
<li>Snackbar: "No account found with this email"</li>
</ul>
</li>
</ol>
</div>
</div>
</div>
<hr>
<h4 id="paso-5-debugging-comun"><strong>Paso 5: Debugging común</strong><a class="headerlink" href="#paso-5-debugging-comun" title="Permanent link">¶</a></h4>
<div class="tabbed-set tabbed-alternate" data-tabs="3:3"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio"><input id="__tabbed_3_2" name="__tabbed_3" type="radio"><input id="__tabbed_3_3" name="__tabbed_3" type="radio"><div class="tabbed-labels"><label for="__tabbed_3_1">Problema 1: "FirebaseAuth has not been initialized</label><label for="__tabbed_3_2">Problema 2: "Email already exists</label><label for="__tabbed_3_3">Problema 3: "Weak password</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p></p><div class="language-text highlight"><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a>java.lang.IllegalStateException: Default FirebaseApp is not initialized
</span></code></pre></div>
<strong>Solución:</strong><p></p>
<ul>
<li>Verifica que <code>google-services.json</code> esté en <code>app/</code></li>
<li>Asegúrate de que el plugin está aplicado en <code>app/build.gradle.kts</code></li>
<li>Sync Gradle de nuevo</li>
</ul>
</div>
<div class="tabbed-block">
<p>Si intentas registrar el mismo email dos veces, Firebase rechazará el segundo intento.</p>
<p><strong>Solución:</strong></p>
<ol>
<li>Ve a Firebase Console → Authentication → Users</li>
<li>Elimina el usuario</li>
<li>Intenta registrar de nuevo</li>
</ol>
</div>
<div class="tabbed-block">
<p>Firebase requiere mínimo 6 caracteres en la contraseña.</p>
<p><strong>Solución:</strong></p>
<ul>
<li>
<p>Actualiza las validaciones en <code>RegisterViewModel</code>:</p>
<div class="language-kotlin highlight"><pre><span></span><code><span id="__span-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">state</span><span class="p">.</span><span class="na">password</span><span class="p">.</span><span class="na">length</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">6</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-37-2"><a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a><span class="w">    </span><span class="n">_uiState</span><span class="p">.</span><span class="na">update</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
</span><span id="__span-37-3"><a id="__codelineno-37-3" name="__codelineno-37-3" href="#__codelineno-37-3"></a><span class="w">        </span><span class="nb">it</span><span class="p">.</span><span class="na">copy</span><span class="p">(</span><span class="n">errorMessage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"Password must be at least 6 characters"</span><span class="p">)</span><span class="w"> </span>
</span><span id="__span-37-4"><a id="__codelineno-37-4" name="__codelineno-37-4" href="#__codelineno-37-4"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-37-5"><a id="__codelineno-37-5" name="__codelineno-37-5" href="#__codelineno-37-5"></a><span class="w">    </span><span class="k">return</span>
</span><span id="__span-37-6"><a id="__codelineno-37-6" name="__codelineno-37-6" href="#__codelineno-37-6"></a><span class="p">}</span>
</span></code></pre></div>
</li>
</ul>
</div>
</div>
</div>
<hr>
<p><u>✅ Resumen de Email/Password</u></p>
<p>Has implementado autenticación completa con Firebase:</p>
<ol>
<li>✅ Habilitado Email/Password en Firebase Console</li>
<li>✅ Creado <code>FirebaseAuthRepositoryImpl</code></li>
<li>✅ Actualizado <code>DataModule</code> con Firebase Auth</li>
<li>✅ Testing completo del flujo de registro y login</li>
<li>✅ Manejo robusto de errores de Firebase</li>
<li>✅ Sincronización automática con Room</li>
</ol>
<p><strong>Ventajas alcanzadas:</strong></p>
<ul>
<li>🔒 Autenticación segura gestionada por Firebase</li>
<li>📦 Sin cambios en ViewModels ni UI (gracias a DI)</li>
<li>🧪 Fácil volver al mock para testing</li>
<li>📱 Persistencia de sesión automática</li>
</ul>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg>
  Volver al principio
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      2025-2026 Jesús García - Licencia CC BY-NC-SA
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
    <a href="mailto:&lt;jssgarcia.docente@gmail.com&gt;" target="_blank" rel="noopener" title="" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 12.13c-.15.01-.29.06-.39.17l-1 1 2.05 2 1-1c.22-.21.22-.56 0-.77l-1.24-1.23a.56.56 0 0 0-.38-.17m-2 1.75L13 19.94V22h2.06l6.06-6.07M20 4H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h7v-.89l8.24-8.22c.47-.49 1.12-.76 1.8-.76.34 0 .68.06 1 .19V6c0-1.12-.92-2-2.04-2m0 4-8 5-8-5V6l8 5 8-5"></path></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["header.autohide", "content.tabs.link", "content.code.copy", "content.code.select", "navigation.top", "content.code.annotate", "navigation.path", "content.tooltips"], "search": "../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version": "Seleccionar versi\u00f3n"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  
<script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(()=>{ lightbox.reload(); });
</script></body></html>